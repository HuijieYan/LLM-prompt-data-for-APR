```python
import numpy as np

def astype_nansafe(arr, dtype, copy: bool = True, skipna: bool = False):

    if isinstance(dtype, np.dtype):
        dtype = dtype
    elif dtype in [np.int64, np.float64, np.str]:
        dtype = np.dtype(dtype)
    else:
        raise TypeError(f"Invalid dtype: {dtype}")

    if dtype.type == str:
        return np.array(arr, dtype=dtype)
    elif np.issubdtype(dtype, np.datetime64):
        if dtype.name == "datetime64":
            dtype = np.dtype('int64')
        elif dtype.name == "timedelta64":
            dtype = np.dtype('int64')

    if arr.dtype in [np.datetime64, np.timedelta64]:
        if np.datetime_data(arr.dtype)[0] == 'm':
            dtype = np.dtype('int64')
    
    return np.array(arr, dtype=dtype)
```