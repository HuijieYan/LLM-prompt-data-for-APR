The issue is that the `apply` function is not correctly handling the business hours with custom holidays. The function needs to be modified to correctly adjust the datetime values based on the business hours and holidays.

Here's a corrected version of the `apply` function:

```python
@apply_wraps
def apply(self, other):
    if isinstance(other, datetime):

        # Adjust business hours based on holidays
        adjusted = self.rollforward(other)
        
        # Get the next business hour
        if self.n > 0:
            for _ in range(self.n):
                adjusted = self.holidays.rollforward(adjusted)
        else:
            for _ in range(-self.n):
                adjusted = self.holidays.rollback(adjusted)
        
        return adjusted

    else:
        raise ApplyTypeError("Only know how to combine business hour with datetime")
```
This modified `apply` function correctly adjusts the business hours based on holidays and handles the edge cases when the number of business hours is negative or positive.

After applying this fix, the failing test should pass without raising any errors.