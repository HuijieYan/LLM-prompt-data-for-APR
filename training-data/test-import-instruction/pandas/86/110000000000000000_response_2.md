# The corrected version of the function
```python
# this is the corrected version of the function
@Appender(_shared_docs["pivot"], indents=1)
def pivot(data: 'DataFrame', index=None, columns=None, values=None) -> 'DataFrame':
    if values is None:
        if index is None:
            raise ValueError("index cannot be None when values are None")

        indexed = data.set_index([index, columns])
    else:
        if index is None:
            index = data.index
            index = MultiIndex.from_arrays([index, data[columns]])
        else:
            index = MultiIndex.from_arrays([data[index], data[columns]])

        if is_list_like(values) and not isinstance(values, tuple):
            # Exclude tuple because it is seen as a single column name
            indexed = data.loc[:, values].set_index(index)
        else:
            indexed = data.loc[:, values].set_index(index)
    return indexed.unstack(columns)

```