The buggy function `table_exists` is failing because it is not handling the case insensitivity of table names. The function is calling the `run_hive_cmd` function and checking if the table exists based on the output. However, it does not account for the case insensitivity of the table names in the output.

To fix this bug, we need to modify the function to handle case insensitivity by converting both the table names to lowercase before comparing them.

Here's the corrected code for the `table_exists` function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables;'.format(database))

        return stdout and table.lower() in map(str.lower, stdout.split())
    else:
        stdout = run_hive_cmd("""use %s; show partitions %s partition
                        (%s)""" % (database, table, self.partition_spec(partition)))

        if stdout:
            return True
        else:
            return False
```

With this correction, the function will now handle case insensitivity of table names and should pass the failing tests.