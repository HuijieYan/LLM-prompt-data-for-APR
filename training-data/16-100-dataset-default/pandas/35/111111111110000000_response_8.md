The issue is with the `_engine` function. It is returning `self._engine_type(period, len(self))` where `_engine_type` returns `None`.

Here's the corrected `_engine` function:

```python
@cache_readonly
def _engine(self):
    # To avoid a reference cycle, pass a weakref of self to _engine_type.
    period = weakref.ref(self)
    engine_type = self._engine_type(period, len(self))
    if engine_type is None:
        raise ValueError("Engine type is None")
    return engine_type
```

This will handle the case where `_engine_type` returns `None` and raise a `ValueError`.