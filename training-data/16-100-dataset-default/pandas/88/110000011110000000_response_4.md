The issue in the `pivot_table` function seems to be causing attribute errors when trying to access the columns of a Series object. To fix the function, we need to ensure that the input `columns` are converted properly to MultiIndex when the function is called.

Here's the corrected version of the function:

```python
def pivot_table(
    data,
    values=None,
    index=None,
    columns=None,
    aggfunc="mean",
    fill_value=None,
    margins=False,
    dropna=True,
    margins_name="All",
    observed=False,
) -> "DataFrame":
    index = _convert_by(index)
    columns = _convert_by(columns)

    # ... (rest of the function remains the same)
```

In this corrected version, the `index` and `columns` variables are correctly being converted using the `_convert_by` function. This should resolve the attribute error issues.

Please note that the solution provided is based on the assumption that the `_convert_by` function handles the conversion to MultiIndex as intended. If it does not, the implementation of the `_convert_by` function would need to be adjusted as well.