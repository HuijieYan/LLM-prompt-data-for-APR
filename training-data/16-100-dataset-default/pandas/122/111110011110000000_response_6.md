```python
# this is the corrected function
def equals(self, other):
    # self._consolidate_inplace() and other._consolidate_inplace() should be called before doing any comparison
    self._consolidate_inplace()
    other._consolidate_inplace()
      
    # Comparison logic start here
    if not self.axes.equals(other.axes):
        return False
        
    for block1, block2 in zip(self.blocks, other.blocks):
        if not block1.equals(block2):
            return False
        
    return True
```