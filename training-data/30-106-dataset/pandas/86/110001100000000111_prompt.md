Please fix the buggy function provided below and output a corrected version.


# The source code of the buggy function
```python
# The relative path of the buggy file: pandas/core/reshape/pivot.py

# this is the buggy function you need to fix
@Substitution("\ndata : DataFrame")
@Appender(_shared_docs["pivot"], indents=1)
def pivot(data: "DataFrame", index=None, columns=None, values=None) -> "DataFrame":
    if values is None:
        cols = [columns] if index is None else [index, columns]
        append = index is None
        indexed = data.set_index(cols, append=append)
    else:
        if index is None:
            index = data.index
        else:
            index = data[index]
        index = MultiIndex.from_arrays([index, data[columns]])

        if is_list_like(values) and not isinstance(values, tuple):
            # Exclude tuple because it is seen as a single column name
            indexed = data._constructor(
                data[values].values, index=index, columns=values
            )
        else:
            indexed = data._constructor_sliced(data[values].values, index=index)
    return indexed.unstack(columns)

```




# A GitHub issue title for this bug
```text
BUG: Wrong error message is raised when columns=None in df.pivot
```

## The GitHub issue's detailed description
```text
From docstring, index and values can be optional in df.pivot, but columns is not

https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot.html
index : string or object, optional
Column to use to make new frame’s index. If None, uses existing index.

columns : string or object
Column to use to make new frame’s columns.

However, the error message is confusing now, should raise columns is not optional.

Code example:
>>> df = pd.DataFrame({"foo": ['one', 'one', 'two', 'two'],"bar": ['A', 'A', 'B', 'C'],"baz": [1, 2, 3, 4]})
>>> df.pivot(columns=None)

KeyError: 'None of [None] are in the columns'
```



1. Analyze the buggy function and it's relationship with the related functions, the github issue.
2. Identify the potential error location within the problematic function.
3. Elucidate the bug's cause using:
   (a). The buggy function
   (b). The related functions
   (c). The GitHub Issue information

4. Suggest possible approaches for fixing the bug.
5. Present the corrected code for the problematic function such that it satisfied the following:
   (a). Successfully resolves the issue posted in GitHub

