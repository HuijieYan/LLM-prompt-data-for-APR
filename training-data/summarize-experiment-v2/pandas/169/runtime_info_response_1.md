In both cases, the function seems to be failing to populate the 'data' variable with the expected values. It is returning an empty DataFrame despite taking input parameters and executing some logic. This suggests that there might be an issue with the core logic of the function, specifically in the portion of the code responsible for populating the 'data' variable. Without being able to see the source code itself it is difficult to identify the exact cause of the issue, but it's likely something related to how the input parameters are being used to generate the expected output DataFrame. Further investigation into how 'data' is being populated is needed to fix this bug.