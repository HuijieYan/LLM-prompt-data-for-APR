Looking at the failing tests and the error messages, it seems that the issue is with the `_dict_arg` function in the `luigi/contrib/spark.py` file. The failing tests are reporting that the lists being compared have differences in the formatting of the `--conf` option.

From the error messages, it appears that the issue is related to the formatting of the `value` for the `--conf` option. The failing tests expect `prop1=val1`, but the `_dict_arg` function is adding double quotes around the value, resulting in `"prop1=val1"`.

To fix this issue, we need to modify the `_dict_arg` function to remove the double quotes when constructing the command list.

Here is the corrected code for the `_dict_arg` function:

```python
def _dict_arg(self, name, value):
    command = []
    if value and isinstance(value, dict):
        for prop, val in value.items():  # changed the variable name from "value" to val to avoid confusion
            command += [name, '{0}={1}'.format(prop, val)]  # removed the double quotes around {0}={1}
    return command
```

By removing the double quotes from `'{0}={1}'.format(prop, val)`, we ensure that the `--conf` option is formatted correctly without the double quotes around the value. This should fix the failing tests.