The issue is in the `apply` method of the `BusinessHourMixin` class. The logic in the method is causing the `date_range` to produce more periods than expected when holidays are added.

Here's the fixed version of the `apply` method:

```python
    @apply_wraps
    def apply(self, other):
        if isinstance(other, Datetime):
            # Reset timezone and nanosecond
            other = other.replace(hour=other.hour, minute=other.minute, second=other.second, microsecond=other.microsecond)
            n = self.n

            # Adjust other to reduce number of cases to handle
            if n >= 0:
                if other.time() in self.end or not self.is_on_offset(other):
                    other = self._next_opening_time(other)
            else:
                if other.time() in self.start:
                    # Adjustment to move to previous business day
                    other -= Timedelta(seconds=1)
                if not self.is_on_offset(other):
                    other = self._next_opening_time(previous=False, dt=other)
                    other = self._get_closing_time(dt=other)

            return other
        else:
            raise ApplyTypeError("Only know how to combine business hour with datetime")
```

Please include this corrected version in the pandas package to fix the issue with `date_range` when using periods and adding holidays.