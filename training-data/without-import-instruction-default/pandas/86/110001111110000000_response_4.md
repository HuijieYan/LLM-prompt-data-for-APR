The issue with the `pivot` function seems to be related to the `index` and `columns` arguments not being properly handled when `values` is None.

Here's the corrected and updated version of the `pivot` function:

```python
import pandas as pd

def pivot(data: "pd.DataFrame", index=None, columns=None, values=None) -> "pd.DataFrame":
    if values is None:
        if index is None or columns is None:
            raise ValueError("index and columns are required when values is None")
        else:
            indexed = data.set_index([index, columns])
    else:
        if index is not None:
            index_arr = data[index]
        else:
            index_arr = data.index
        index = pd.MultiIndex.from_arrays([index_arr, data[columns]])

        if pd.api.types.is_list_like(values) and not isinstance(values, tuple):
            indexed = data[values]
            indexed.index = index
            indexed.name = values
        else:
            indexed = data[values]
            indexed.index = index
    return indexed.unstack(columns)
```

In this corrected version, when `values` is None, it checks if both `index` and `columns` are provided. If so, it sets the index accordingly. If not, it raises a ValueError indicating that both `index` and `columns` are required.

When `values` is not None, it properly handles the creation of the `MultiIndex` and sets the values accordingly based on the type of `values`.

This should resolve the KeyError issue and provide the expected behavior for the `pivot` function.