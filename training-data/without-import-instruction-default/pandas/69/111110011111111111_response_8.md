The issue seems to be with the `_convert_key` function. More specifically, the problem appears to be in the block of code that checks the type of the index and the type of the key. The code is meant to ensure that the key is of the same type as the index, but it seems to be raising an error when it should not.

The failing tests are related to datetime and timedelta indexes, and the error message indicates that the function is raising a ValueError for non-integer indexes. This suggests that the issue lies in the type checking logic in the `_convert_key` function.

The GitHub issue title suggests that it might be related to corner cases in `DTI.get_value` and `Float64Index.get_value`. This aligns with the failing tests that involve `Float64Index`.

To fix the bug, the type checking logic in the `_convert_key` function needs to be revised to correctly handle cases with datetime and timedelta indexes. Specifically, it should allow non-integer indexers for non-integer indexes.

The corrected code for the `_convert_key` function is provided below:

```python
def _convert_key(self, key, is_setter: bool = False):
    """
    Require they keys to be the same type as the index. (so we don't
    fallback)
    """
    # allow arbitrary setting
    if is_setter:
        return list(key)

    for ax, i in zip(self.obj.axes, key):
        if ax.is_integer():
            if not isinstance(i, int) and not isinstance(i, np.int64) and not isinstance(i, np.int32):
                raise ValueError(
                    "At based indexing on an integer index "
                    "can only have integer indexers"
                )
        else:
            if not isinstance(i, float) and not isinstance(i, np.float64) and not isinstance(i, np.float32):
                raise ValueError(
                    "At based indexing on an non-integer "
                    "index can only have non-integer "
                    "indexers"
                )
    return key
```

This corrected code changes the type checking logic to explicitly check for integer and float types, including NumPy integer and float types, to accommodate the datetime and timedelta indexes. This should ensure that the function passes the failing tests and resolves the issue posted on GitHub.