```python
import numpy as np

def astype_nansafe(arr, dtype, copy=True, skipna=False):
    if not isinstance(dtype, np.dtype):
        dtype = np.dtype(dtype)

    if np.issubdtype(arr.dtype, np.floating) and np.issubdtype(dtype, np.integer):
        if not np.isfinite(arr).all():
            raise ValueError("Cannot convert non-finite values (NA or inf) to integer")

    if np.issubdtype(dtype, np.integer) and (arr.dtype.name in ['category', 'object']):
        result = arr.copy()
        result = result.fillna(np.nan)
        result = result.astype(dtype)
        return result

    return arr.astype(dtype, copy=copy)

```