```python
import numpy as np
from pandas.api.types import is_datetime64_any_dtype, is_timedelta64_any_dtype

def astype_nansafe(arr, dtype, copy: bool = True, skipna: bool = False):

    if np.issubdtype(dtype, np.datetime_data):
        if dtype.name not in ["datetime64", "timedelta64"]:
            raise ValueError(f"The '{dtype.name}' dtype has no unit. Please pass in '{dtype.name}[ns]' instead.")
    elif is_datetime64_any_dtype(dtype):
        dtype = np.dtype('int64')
    elif is_timedelta64_any_dtype(dtype):
        dtype = np.dtype('int64')

    if copy or is_object_dtype(arr) or is_object_dtype(dtype):
        return arr.astype(dtype, copy=True)
    else:
        return arr.view(dtype)
```