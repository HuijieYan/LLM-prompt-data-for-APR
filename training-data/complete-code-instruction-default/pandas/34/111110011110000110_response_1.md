```python
def _get_time_bins(self, ax):
    if not isinstance(ax, DatetimeIndex):
        raise TypeError(
            "axis must be a DatetimeIndex, but got "
            f"an instance of {type(ax).__name__}"
        )

    if len(ax) == 0:
        binner = labels = DatetimeIndex(data=[], freq=self.freq, name=ax.name)
        return binner, [], labels

    first, last = ax.min().ceil(self.freq), ax.max().ceil(self.freq)
    bins = np.arange(first.value, last.value, self.freq.nanos).astype("datetime64[ns]")
    binner = np.concatenate([[first.value], bins])
    labels = np.concatenate([bins, [last.value]])
    
    return binner, bins, labels
```