```python
@Appender(_index_shared_docs["get_indexer_non_unique"] % _index_doc_kwargs)
def get_indexer_non_unique(self, target):
    """
    Get the index values to use to get from self to target.
    If target is not unique, this creates integer indices from the
    index into target.
    If the index is unique, this returns an indexer of Int64
    (matched to the target). Otherwise, it returns an object array.
    
    Parameters
    ----------
    target : Index or array-like
    
    Returns
    -------
    indexer : np.array
    missing : np.array
        Each array will be of the appropriate type for the type
        of indexer
        
    See Also
    --------
    Index.get_indexer
    ```

    target = ensure_index(target)
    pself, ptarget = self._maybe_promote(target)
    if pself is not self or ptarget is not target:
        return pself.get_indexer_non_unique(ptarget)

    if self.is_categorical(target):
        tgt_values = np.asarray(target)
    elif self.is_all_dates:
        tgt_values = target.asi8()
    else:
        tgt_values = target._ndarray_values()

    indexer, missing = self._engine().get_indexer_non_unique(tgt_values)
    return ensure_platform_int(indexer), missing
```