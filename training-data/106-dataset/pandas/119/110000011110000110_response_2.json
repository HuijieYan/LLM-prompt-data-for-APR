{
    "pandas": [
        {
            "bugID": 119,
            "bitvector": {
                "1.1.1": 1,
                "1.1.2": 1,
                "1.2.1": 0,
                "1.2.2": 0,
                "1.2.3": 0,
                "1.3.1": 0,
                "1.3.2": 0,
                "1.4.1": 1,
                "1.4.2": 1,
                "2.1.1": 1,
                "2.1.2": 1,
                "2.1.3": 0,
                "2.1.4": 0,
                "2.1.5": 0,
                "2.1.6": 0,
                "3.1.1": 1,
                "3.1.2": 1,
                "cot": 0
            },
            "strata": {
                "1": 1,
                "2": 0,
                "3": 0,
                "4": 1,
                "5": 0,
                "6": 1,
                "7": 0
            },
            "available_bitvector": {
                "1.1.1": 1,
                "1.1.2": 0,
                "1.2.1": 0,
                "1.2.2": 0,
                "1.2.3": 0,
                "1.3.1": 0,
                "1.3.2": 0,
                "1.4.1": 1,
                "1.4.2": 1,
                "2.1.1": 1,
                "2.1.2": 1,
                "2.1.3": 0,
                "2.1.4": 0,
                "2.1.5": 0,
                "2.1.6": 0,
                "3.1.1": 1,
                "3.1.2": 1,
                "cot": 0
            },
            "available_strata": {
                "1": 1,
                "2": 0,
                "3": 0,
                "4": 1,
                "5": 0,
                "6": 1,
                "7": 0
            },
            "start_line": 187,
            "file_name": "pandas/core/reshape/pivot.py",
            "replace_code": "def _add_margins(\n    table: Union[Series, DataFrame],\n    data: DataFrame,\n    values: Any,\n    rows: Any,\n    cols: Any,\n    aggfunc: Any,\n    observed=None,\n    margins_name: str = \"All\",\n    fill_value=None,\n):\n    if not isinstance(margins_name, str):\n        raise ValueError(\"margins_name argument must be a string\")\n\n    msg = f'Conflicting name \"{margins_name}\" in margins'\n    \n    if isinstance(table.index, MultiIndex):\n        for level in table.index.names:\n            if margins_name in table.index.get_level_values(level):\n                raise ValueError(msg)\n\n    grand_margin = table\n\n    if isinstance(table.columns, MultiIndex):\n        for level in table.columns.names[1:]:\n            if margins_name in table.columns.get_level_values(level):\n                raise ValueError(msg)\n\n    key: Union[str, Tuple[str, ...]]\n    if len(rows) > 1:\n        key = (margins_name,) + (\"\",) * (len(rows) - 1)\n    else:\n        key = margins_name\n\n    if not values and isinstance(table, Series):\n        return table.append(Series({key: grand_margin[margins_name]}))\n    elif values:\n        marginal_result_set = (table, data, values, rows, cols, aggfunc, observed, grand_margin, margins_name)\n    else:\n        assert isinstance(table, DataFrame)\n        marginal_result_set = (table, data, rows, cols, aggfunc, observed, margins_name)\n\n    result, margin_keys, row_margin = _generate_marginal_results_without_values(\n        *marginal_result_set)\n\n    row_margin = row_margin.reindex(result.columns, fill_value=fill_value)\n\n    for k in margin_keys:\n        if isinstance(k, str):\n            row_margin[k] = grand_margin[k]\n        else:\n            row_margin[k] = grand_margin[k[0]]\n\n    margin_dummy = DataFrame(row_margin, columns=[key]).T\n\n    row_names = result.index.names\n    try:\n        for dtype in set(result.dtypes):\n            cols = result.select_dtypes([dtype]).columns\n            margin_dummy[cols] = margin_dummy[cols].astype(dtype)\n        result = result.append(margin_dummy)\n    except TypeError:\n\n        result.index = result.index._to_safe_for_reshape()\n        result = result.append(margin_dummy)\n    result.index.names = row_names\n\n    return result",
            "imports": [
                "from typing import Union, Tuple, Any",
                "import pandas as pd",
                "from pandas import Series, DataFrame, Index",
                "from pandas.core.groupby.generic import DataFrameGroupBy, SeriesGroupBy",
                "from pandas.core.indexes.multi import MultiIndex",
                "from pandas.core.series import Series, Index",
                "import pandas._testing as tm"
            ]
        }
    ]
}