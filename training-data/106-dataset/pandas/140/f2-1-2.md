# Error stack trace

```json
[
    [
        "group_column_dtlike = datetime.datetime(2023, 12, 11, 14, 9, 50, 314762)\n\n    @pytest.mark.parametrize(\n        \"group_column_dtlike\",\n        [datetime.today(), datetime.today().date(), datetime.today().time()],\n    )\n    def test_apply_datetime_issue(group_column_dtlike):\n        # GH-28247\n        # groupby-apply throws an error if one of the columns in the DataFrame\n        #   is a datetime object and the column labels are different from\n        #   standard int values in range(len(num_columns))\n    \n        df = pd.DataFrame({\"a\": [\"foo\"], \"b\": [group_column_dtlike]})\n>       result = df.groupby(\"a\").apply(lambda x: pd.Series([\"spam\"], index=[42]))\n\npandas/tests/groupby/test_apply.py:673: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \npandas/core/groupby/groupby.py:727: in apply\n    result = self._python_apply_general(f)\npandas/core/groupby/groupby.py:745: in _python_apply_general\n    return self._wrap_applied_output(\npandas/core/groupby/generic.py:516: in _wrap_applied_output\n    result = _recast_datetimelike_result(result)\npandas/core/groupby/generic.py:1915: in _recast_datetimelike_result\n    obj_cols = [\npandas/core/groupby/generic.py:1916: in <listcomp>\n    idx for idx in range(len(result.columns)) if is_object_dtype(result.dtypes[idx])\npandas/core/series.py:1081: in __getitem__\n    result = self.index.get_value(self, key)\npandas/core/indexes/base.py:4658: in get_value\n    return self._engine.get_value(s, k, tz=getattr(series.dtype, \"tz\", None))\npandas/_libs/index.pyx:77: in pandas._libs.index.IndexEngine.get_value\n    cpdef get_value(self, ndarray arr, object key, object tz=None):\npandas/_libs/index.pyx:85: in pandas._libs.index.IndexEngine.get_value\n    loc = self.get_loc(key)\npandas/_libs/index.pyx:128: in pandas._libs.index.IndexEngine.get_loc\n    return self.mapping.get_item(val)\npandas/_libs/hashtable_class_helper.pxi:992: in pandas._libs.hashtable.Int64HashTable.get_item\n    cpdef get_item(self, int64_t val):\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n>   raise KeyError(val)",
        "\npandas/_libs/hashtable_class_helper.pxi:998: KeyError"
    ]
]
```
