```python
# The relative path of the buggy file: keras/models.py

def _clone_functional_model(model, input_tensors=None):
    from tensorflow.python.keras.engine.functional import Functional
    from tensorflow.python.keras.models import Sequential
    from tensorflow.python.keras.engine.input_layer import InputLayer
    from tensorflow.python.keras.engine.network import Network
    from tensorflow.python.keras.layers import Input

    # ... (the rest of the function remains the same)

    if not isinstance(model, (Functional, Sequential, Network)):
        raise ValueError('Expected `model` argument to be a functional `Model` instance, got ', model)

    layer_map = {}  # Cache for created layers.
    tensor_map = {}  # Map {reference_tensor: (corresponding_tensor, mask)}

    # ... (the rest of the function remains the same)
```