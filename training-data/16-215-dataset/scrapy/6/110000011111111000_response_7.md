The issue in the `convert_image` function is that the `RGBA` images are not being converted to the `RGB` mode correctly. Additionally, the thumbnail is not being generated with the correct size. This is leading to failing test cases.

Here's the corrected version of the `convert_image` function:

```python
from PIL import Image, ImageFile
from io import BytesIO

def convert_image(self, image, size=None):
    if image.format == 'PNG' and image.mode == 'RGBA':
        background = Image.new('RGB', image.size, (255, 255, 255))
        background.paste(image, mask=image.split()[3])  # Use the alpha channel as a mask
        image = background
    elif image.mode not in ('RGB', 'L', '1', 'CMYK'):
        image = image.convert('RGB')

    if size:
        image = image.copy()
        image.thumbnail(size, Image.ANTIALIAS)

    buf = BytesIO()
    image.save(buf, 'JPEG')
    return image, buf
```

In this corrected version, the `RGBA` images are correctly converted to `RGB` mode using the alpha channel as a mask. Additionally, the images in modes other than `RGB`, `'L'`, `'1'`, and `'CMYK'` are converted to `RGB` mode. The thumbnail size is also generated correctly.

After applying this correction, the failing test cases should pass, and the error message should no longer appear.