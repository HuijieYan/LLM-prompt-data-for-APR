The bug in the function is that it does not handle the case where the image format is 'PNG' and the mode is 'RGBA' correctly. In this case, it should create a new image with the RGBA mode and paste the original image onto it before converting it to the RGB mode. Additionally, when the size parameter is provided, it should be used to create a thumbnail of the image.

To fix the bug, we can modify the `convert_image` function as follows:

```python
from PIL import Image
from io import BytesIO
from scrapy.pipelines.files import FilesPipeline

class ImagesPipeline(FilesPipeline):
    """
    Abstract pipeline that implement the image thumbnail generation logic
    """

    def convert_image(self, image, size=None):
        if image.format == 'PNG' and image.mode == 'RGBA':
            background = Image.new('RGBA', image.size, (255, 255, 255))
            background.paste(image, (0, 0), image)
            image = background.convert('RGB')
        elif image.mode != 'RGB':
            image = image.convert('RGB')

        if size:
            image = image.copy()
            image.thumbnail(size, Image.ANTIALIAS)

        buf = BytesIO()
        image.save(buf, 'JPEG')
        return image, buf
```

With this corrected code, the function should now handle all cases as expected and return the correct values for the given inputs.