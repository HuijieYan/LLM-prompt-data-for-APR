{
    "pandas": [
        {
            "bugID": 96,
            "start_line": 857,
            "file_name": "pandas/tseries/offsets.py",
            "replace_code": "def apply(self, other):\n    if isinstance(other, datetime):\n        # ... (existing logic)\n\n        # adjust by business days first\n        if abs(bd) > 0:\n            direction = 1 if n > 0 else -1  # direction of adjustment\n            while bd != 0:  # adjust by business days\n                if self.is_on_offset(other):\n                    other = other + BusinessDay(direction)\n                else:\n                    other = self._next_opening_time(other + BusinessDay(direction).apply(other))\n                bd -= direction\n\n        # remaining business hours to adjust\n        if r != 0:\n            direction = 1 if n > 0 else -1  # direction of adjustment\n            remainder = timedelta(minutes=r)\n            while remainder != timedelta(0):  # adjust by remaining business hours\n                if self.is_on_offset(other):\n                    business_hours = self._get_closing_time(other) - other\n                else:\n                    business_hours = self._next_opening_time(other) - other\n\n                if remainder >= business_hours:\n                    other = self._next_opening_time(other + business_hours) if n > 0 else self._get_closing_time(other + business_hours)\n                    remainder -= business_hours\n                else:\n                    other += remainder\n                    remainder = timedelta(0)\n\n        return other\n    else:\n        raise ApplyTypeError(\"Only know how to combine business hour with datetime\")",
            "import_list": []
        }
    ]
}