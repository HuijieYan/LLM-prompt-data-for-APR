The problem lies in the way the `table_exists` function is using the `run_hive_cmd` and `partition_spec` functions. It is not properly calling the `partition_spec` function and is missing a check for the output of `run_hive_cmd`. Additionally, the current way it checks for the existence of a table in the output of `run_hive_cmd` is not correct.

To fix the bug, the `table_exists` function should be modified to handle the `partition` parameter properly and to check the output of `run_hive_cmd` correctly.

Here's the corrected code for the `table_exists` function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))
        return 'OK' in stdout.split('\n')

    else:
        partition_str = ','.join([f'{k}={v}' for k, v in partition.items()])
        stdout = run_hive_cmd("use {0}; show partitions {1}.{2} partition ({3});".format(database, database, table, partition_str))
        return stdout != ""
```

This correction will properly handle the case when the `partition` parameter is not None and the case when it is None. It also checks the output of `run_hive_cmd` correctly and returns the boolean results as expected in the provided test cases.