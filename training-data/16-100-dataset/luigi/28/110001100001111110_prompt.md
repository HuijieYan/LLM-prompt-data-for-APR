Please fix the buggy function provided below and output a corrected version.


# The source code of the buggy function
```python
# The relative path of the buggy file: luigi/contrib/hive.py

# This function from the same file, but not the same class, is called by the buggy function
def run_hive_cmd(hivecmd, check_return_code=True):
    # Please ignore the body of this function

# This function from the same file, but not the same class, is called by the buggy function
def partition_spec(self, partition):
    # Please ignore the body of this function

# This function from the same file, but not the same class, is called by the buggy function
def partition_spec(self, partition):
    # Please ignore the body of this function

# This function from the same file, but not the same class, is called by the buggy function
def partition_spec(self, partition):
    # Please ignore the body of this function

# this is the buggy function you need to fix
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))

        return stdout and table in stdout
    else:
        stdout = run_hive_cmd("""use %s; show partitions %s partition
                            (%s)""" % (database, table, self.partition_spec(partition)))

        if stdout:
            return True
        else:
            return False

```

# Runtime value and type of variables inside the buggy function
Each case below includes input parameter value and type, and the value and type of relevant variables at the function's return, derived from executing failing tests. If an input parameter is not reflected in the output, it is assumed to remain unchanged. Note that some of these values at the function's return might be incorrect. Analyze these cases to identify why the tests are failing to effectively fix the bug.

## Case 1
### Runtime value and type of the input parameters of the buggy function
database, value: `'default'`, type: `str`

table, value: `'mytable'`, type: `str`

### Runtime value and type of variables right before the buggy function's return
stdout, value: `'OK'`, type: `str`

## Case 2
### Runtime value and type of the input parameters of the buggy function
database, value: `'default'`, type: `str`

table, value: `'MyTable'`, type: `str`

### Runtime value and type of variables right before the buggy function's return
stdout, value: `'OK\nmytable'`, type: `str`

## Case 3
### Runtime value and type of the input parameters of the buggy function
partition, value: `{'a': 'b'}`, type: `dict`

database, value: `'default'`, type: `str`

table, value: `'mytable'`, type: `str`

self.partition_spec, value: `<Mock name='partition_spec' id='4412340208'>`, type: `Mock`

### Runtime value and type of variables right before the buggy function's return
stdout, value: `'day=2013-06-28/hour=3\nday=2013-06-28/hour=4\nday=2013-07-07/hour=2\n'`, type: `str`

## Case 4
### Runtime value and type of the input parameters of the buggy function
database, value: `'default'`, type: `str`

table, value: `'mytable'`, type: `str`

### Runtime value and type of variables right before the buggy function's return
stdout, value: `'OK'`, type: `str`

## Case 5
### Runtime value and type of the input parameters of the buggy function
database, value: `'default'`, type: `str`

table, value: `'MyTable'`, type: `str`

### Runtime value and type of variables right before the buggy function's return
stdout, value: `'OK\nmytable'`, type: `str`

## Case 6
### Runtime value and type of the input parameters of the buggy function
partition, value: `{'a': 'b'}`, type: `dict`

database, value: `'default'`, type: `str`

table, value: `'mytable'`, type: `str`

self.partition_spec, value: `<Mock name='partition_spec' id='4412829648'>`, type: `Mock`

### Runtime value and type of variables right before the buggy function's return
stdout, value: `'day=2013-06-28/hour=3\nday=2013-06-28/hour=4\nday=2013-07-07/hour=2\n'`, type: `str`



# Expected value and type of variables during the failing test execution
Each case below includes input parameter value and type, and the expected value and type of relevant variables at the function's return. If an input parameter is not reflected in the output, it is assumed to remain unchanged. A corrected function must satisfy all these cases.

## Expected case 1
### Input parameter value and type
database, value: `'default'`, type: `str`

table, value: `'mytable'`, type: `str`

### Expected value and type of variables right before the buggy function's return
stdout, expected value: `'OK'`, type: `str`

## Expected case 2
### Input parameter value and type
database, value: `'default'`, type: `str`

table, value: `'MyTable'`, type: `str`

### Expected value and type of variables right before the buggy function's return
stdout, expected value: `'OK\nmytable'`, type: `str`

## Expected case 3
### Input parameter value and type
database, value: `'default'`, type: `str`

table, value: `'mytable'`, type: `str`

### Expected value and type of variables right before the buggy function's return
stdout, expected value: `'OK'`, type: `str`

## Expected case 4
### Input parameter value and type
database, value: `'default'`, type: `str`

table, value: `'MyTable'`, type: `str`

### Expected value and type of variables right before the buggy function's return
stdout, expected value: `'OK\nmytable'`, type: `str`







# A GitHub issue title for this bug
```text
hive table_exists should be case insensitive?
```

## The GitHub issue's detailed description
```text
Any thoughts on this one?\n\nIn https://github.com/spotify/luigi/blob/master/luigi/contrib/hive.py#L141\n(possibly here too, but we're not on CDH: https://github.com/spotify/luigi/blob/master/luigi/contrib/hive.py#L192)\n\nSometimes we have tables that are defined as capitalized, rather than lower case underscored names. These are easier to read in code if left capitalized, though hive is case insensitive, and will return them as lower case.\n\nE.g. when checking for an existing table table = 'FooBar', stdout will return with foobar and the test will fail\n\nThis wasn't an issue in older versions, which just checked for string \"does not exist\" or \"Table not found\" in stdout.\n\nWould be easy to fix using return stdout and table.lower() in stdout or return stdout and table.lower() in stdout.lower()\n\nLet me know your thoughts on this. I can supply a pull request if necessary.\n\nThanks,\nLin.
```

# A GitHub issue title for this bug
```text
Fix #896: make table_exists case insensitive
```

## The GitHub issue's detailed description
```text
Check stdout against table.lower() to avoid case issues
```



