```python
import pandas as pd
from pandas import DatetimeIndex, NaT
from pandas.tseries.frequencies import to_offset

def _get_time_bins(self, ax):
    if not isinstance(ax, DatetimeIndex):
        raise TypeError(
            "axis must be a DatetimeIndex, but got "
            f"an instance of {type(ax).__name__}"
        )

    if len(ax) == 0:
        binner = labels = DatetimeIndex(data=[], freq=self.freq, name=ax.name, tz=ax.tz)
        return binner, [], labels

    first, last = ax[[0, -1]]
    offset = to_offset(self.freq)
    bins = offset.generate_range(first, last)

    bin_edges = bins
    binner = bins
    labels = bins

    ax_values = ax.asi8
    if self.closed == "right":
        labels = labels[1:] if self.label == "right" else labels
    elif self.label == "right":
        labels = labels[1:]

    if ax_values.hasnans:
        labels = labels.insert(0, NaT)
        binner = labels.insert(0, NaT)

    if len(bins) < len(labels):
        labels = labels[:len(bins)]

    return binner, bins, labels
```