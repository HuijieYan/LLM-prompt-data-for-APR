```python
def equals(self, other):
    self._consolidate_inplace()
    other._consolidate_inplace()
    self_blocks = sorted(self.blocks, key=lambda x: (x.values._get_dtype(), x.mgr_locs.as_array.tolist()))
    other_blocks = sorted(other.blocks, key=lambda x: (x.values._get_dtype(), x.mgr_locs.as_array.tolist()))
    return len(self.axes) == len(other.axes) and all(ax1.equals(ax2) for ax1, ax2 in zip(self.axes, other.axes)) and len(self.blocks) == len(other.blocks) and all(block.equals(oblock) for block, oblock in zip(self_blocks, other_blocks))
```