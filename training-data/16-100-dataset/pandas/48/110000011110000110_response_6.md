```python
def _cython_agg_blocks(
    self, how: str, alt=None, numeric_only: bool = True, min_count: int = -1
) -> "Tuple[List[Block], Index]":
    ...
    for block in data.blocks:
        ...
        if result is not no_result:
            # see if we can cast the block back to the original dtype
            result = maybe_downcast_numeric(result, block.dtype)

            if block.is_extension and isinstance(result, np.ndarray):
                # e.g. block.values was an IntegerArray
                # (1, N) case can occur if block.values was Categorical
                #  and result is ndarray[object]
                assert result.ndim == 1 or result.shape[0] == 1
                try:
                    # Cast back if feasible
                    result = type(block.values)._from_sequence(
                        result.ravel(), dtype=block.values.dtype
                    )
                except (ValueError, TypeError):
                    # reshape to be valid for non-Extension Block
                    result = result.reshape(1, -1)

            agg_block: Block = block.make_block(result)

        if result is not no_result:
            new_items.append(locs)
            agg_blocks.append(agg_block)

    ...

    return agg_blocks, agg_items
```