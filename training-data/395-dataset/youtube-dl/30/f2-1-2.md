# Error stack trace

```json
[
    [
        "self = <test.test_YoutubeDL.TestFormatSelection testMethod=test_format_filtering>\n\n    def test_format_filtering(self):\n        formats = [\n            {'format_id': 'A', 'filesize': 500, 'width': 1000},\n            {'format_id': 'B', 'filesize': 1000, 'width': 500},\n            {'format_id': 'C', 'filesize': 1000, 'width': 400},\n            {'format_id': 'D', 'filesize': 2000, 'width': 600},\n            {'format_id': 'E', 'filesize': 3000},\n            {'format_id': 'F'},\n            {'format_id': 'G', 'filesize': 1000000},\n        ]\n        for f in formats:\n            f['url'] = 'http://_/'\n            f['ext'] = 'unknown'\n        info_dict = _make_result(formats)\n    \n        ydl = YDL({'format': 'best[filesize<3000]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'D')\n    \n        ydl = YDL({'format': 'best[filesize<=3000]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'E')\n    \n        ydl = YDL({'format': 'best[filesize <= ? 3000]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'F')\n    \n        ydl = YDL({'format': 'best [filesize = 1000] [width>450]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'B')\n    \n        ydl = YDL({'format': 'best [filesize = 1000] [width!=450]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'C')\n    \n        ydl = YDL({'format': '[filesize>?1]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'G')\n    \n        ydl = YDL({'format': '[filesize<1M]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'E')\n    \n        ydl = YDL({'format': '[filesize<1MiB]'})\n        ydl.process_ie_result(info_dict)\n        downloaded = ydl.downloaded_info_dicts[0]\n        self.assertEqual(downloaded['format_id'], 'G')\n    \n        ydl = YDL({'format': 'all[width>=400][width<=600]'})\n        ydl.process_ie_result(info_dict)\n        downloaded_ids = [info['format_id'] for info in ydl.downloaded_info_dicts]\n        self.assertEqual(downloaded_ids, ['B', 'C', 'D'])\n    \n        ydl = YDL({'format': 'best[height<40]'})\n        try:\n>           ydl.process_ie_result(info_dict)\n\ntest/test_YoutubeDL.py:367: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nyoutube_dl/YoutubeDL.py:713: in process_ie_result\n    return self.process_video_result(ie_result, download=download)\nyoutube_dl/YoutubeDL.py:1272: in process_video_result\n    formats_to_download = list(format_selector(formats))\nyoutube_dl/YoutubeDL.py:990: in selector_function\n    for format in f(formats):\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nformats = []\n\n    def selector_function(formats):\n        if format_spec == 'all':\n            for f in formats:\n                yield f\n        elif format_spec in ['best', 'worst', None]:\n            format_idx = 0 if format_spec == 'worst' else -1\n            audiovideo_formats = [\n                f for f in formats\n                if f.get('vcodec') != 'none' and f.get('acodec') != 'none']\n            if audiovideo_formats:\n                yield audiovideo_formats[format_idx]\n            # for audio only (soundcloud) or video only (imgur) urls, select the best/worst audio format\n            elif (all(f.get('acodec') != 'none' for f in formats) or\n                  all(f.get('vcodec') != 'none' for f in formats)):\n>               yield formats[format_idx]",
        "\nyoutube_dl/YoutubeDL.py:1021: IndexError"
    ]
]
```
