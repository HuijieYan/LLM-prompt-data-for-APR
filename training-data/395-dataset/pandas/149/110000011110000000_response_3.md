```python
def write(self, df, path, compression="snappy", index=None, partition_cols=None, **kwargs):
    self.validate_dataframe(df)
    if "partition_on" in kwargs and partition_cols is not None:
        raise ValueError("Cannot use both partition_on and partition_cols. Use partition_cols for partitioning data")
    elif "partition_on" in kwargs:
        partition_cols = kwargs.pop("partition_on")
    
    if partition_cols is not None:
        kwargs["file_scheme"] = "hive"
    
    if is_s3_url(path):
        path, _, _, mode = get_filepath_or_buffer(path, mode="wb")
        with open(path, mode) as f:
            kwargs["open_with"] = lambda p, mode: f

    else:
        path, _, _, _ = get_filepath_or_buffer(path)
    
    self.api.write(
        path,
        df,
        compression=compression,
        write_index=index,
        partition_on=partition_cols,
        **kwargs
    )
```