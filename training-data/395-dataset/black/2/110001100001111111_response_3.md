```python
def generate_ignored_nodes(leaf: Leaf) -> Iterator[LN]:
        """Starting from the container of `leaf`, generate all leaves until `# fmt: on`.
    
        Stops at the end of the block.
        """
        container: Optional[LN] = container_of(leaf)
        while container is not None and container.type != token.ENDMARKER:
            is_fmt_on = False
            for comment in list_comments(container.prefix):  # removed is_endmarker=False
                if comment.value in FMT_ON:
                    is_fmt_on = True
                elif comment.value in FMT_OFF:
                    is_fmt_on = False
            if is_fmt_on:
                break  # changed return to break
    
            yield container
    
            container = container.next_sibling
```