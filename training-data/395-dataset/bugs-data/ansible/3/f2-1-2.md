# Error stack trace

```json
[
    [
        "am = <ansible.module_utils.basic.AnsibleModule object at 0x110505d50>\nmocker = <pytest_mock.plugin.MockerFixture object at 0x110510890>\ntestcase = {'distro': {'codename': 'kali-rolling', 'id': 'kali', 'lsb_release_info': {}, 'name': 'Kali GNU/Linux Rolling', ...}, ....org/\"\\nBUG_REPORT_URL=\"https://bugs.kali.org/\"'}, 'name': 'Kali 2020.2', 'platform.dist': ['kali', '2020.2', ''], ...}\n\n    @pytest.mark.parametrize(\"stdin, testcase\", product([{}], TESTSETS), ids=lambda x: x.get('name'), indirect=['stdin'])\n    def test_distribution_version(am, mocker, testcase):\n        \"\"\"tests the distribution parsing code of the Facts class\n    \n        testsets have\n        * a name (for output/debugging only)\n        * input files that are faked\n          * those should be complete and also include \"irrelevant\" files that might be mistaken as coming from other distributions\n          * all files that are not listed here are assumed to not exist at all\n        * the output of ansible.module_utils.distro.linux_distribution() [called platform.dist() for historical reasons]\n        * results for the ansible variables distribution* and os_family\n    \n        \"\"\"\n    \n        # prepare some mock functions to get the testdata in\n        def mock_get_file_content(fname, default=None, strip=True):\n            \"\"\"give fake content if it exists, otherwise pretend the file is empty\"\"\"\n            data = default\n            if fname in testcase['input']:\n                # for debugging\n                print('faked %s for %s' % (fname, testcase['name']))\n                data = testcase['input'][fname].strip()\n            if strip and data is not None:\n                data = data.strip()\n            return data\n    \n        def mock_get_uname(am, flags):\n            if '-v' in flags:\n                return testcase.get('uname_v', None)\n            elif '-r' in flags:\n                return testcase.get('uname_r', None)\n            else:\n                return None\n    \n        def mock_file_exists(fname, allow_empty=False):\n            if fname not in testcase['input']:\n                return False\n    \n            if allow_empty:\n                return True\n            return bool(len(testcase['input'][fname]))\n    \n        def mock_platform_system():\n            return testcase.get('platform.system', 'Linux')\n    \n        def mock_platform_release():\n            return testcase.get('platform.release', '')\n    \n        def mock_platform_version():\n            return testcase.get('platform.version', '')\n    \n        def mock_distro_name():\n            return testcase['distro']['name']\n    \n        def mock_distro_id():\n            return testcase['distro']['id']\n    \n        def mock_distro_version(best=False):\n            if best:\n                return testcase['distro']['version_best']\n            return testcase['distro']['version']\n    \n        def mock_distro_codename():\n            return testcase['distro']['codename']\n    \n        def mock_distro_os_release_info():\n            return testcase['distro']['os_release_info']\n    \n        def mock_distro_lsb_release_info():\n            return testcase['distro']['lsb_release_info']\n    \n        def mock_open(filename, mode='r'):\n            if filename in testcase['input']:\n                file_object = mocker.mock_open(read_data=testcase['input'][filename]).return_value\n                file_object.__iter__.return_value = testcase['input'][filename].splitlines(True)\n            else:\n                file_object = real_open(filename, mode)\n            return file_object\n    \n        def mock_os_path_is_file(filename):\n            if filename in testcase['input']:\n                return True\n            return False\n    \n        mocker.patch('ansible.module_utils.facts.system.distribution.get_file_content', mock_get_file_content)\n        mocker.patch('ansible.module_utils.facts.system.distribution.get_uname', mock_get_uname)\n        mocker.patch('ansible.module_utils.facts.system.distribution._file_exists', mock_file_exists)\n        mocker.patch('ansible.module_utils.distro.name', mock_distro_name)\n        mocker.patch('ansible.module_utils.distro.id', mock_distro_id)\n        mocker.patch('ansible.module_utils.distro.version', mock_distro_version)\n        mocker.patch('ansible.module_utils.distro.codename', mock_distro_codename)\n        mocker.patch(\n            'ansible.module_utils.common.sys_info.distro.os_release_info',\n            mock_distro_os_release_info)\n        mocker.patch(\n            'ansible.module_utils.common.sys_info.distro.lsb_release_info',\n            mock_distro_lsb_release_info)\n        mocker.patch('os.path.isfile', mock_os_path_is_file)\n        mocker.patch('platform.system', mock_platform_system)\n        mocker.patch('platform.release', mock_platform_release)\n        mocker.patch('platform.version', mock_platform_version)\n    \n        real_open = builtins.open\n        mocker.patch.object(builtins, 'open', new=mock_open)\n    \n        # run Facts()\n        distro_collector = DistributionFactCollector()\n        generated_facts = distro_collector.collect(am)\n    \n        # compare with the expected output\n    \n        # testcase['result'] has a list of variables and values it expects Facts() to set\n        for key, val in testcase['result'].items():\n            assert key in generated_facts\n            msg = 'Comparing value of %s on %s, should: %s, is: %s' %\\\n                (key, testcase['name'], val, generated_facts[key])\n>           assert generated_facts[key] == val, msg",
        "\ntest/units/module_utils/test_distribution_version.py:1965: AssertionError"
    ]
]
```
