# Error stack trace

```json
[
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestDatetimeIndexSetOps object at 0x1195bd490>\ntz_aware_fixture = 'UTC', freq = 'B'\n\n    @pytest.mark.parametrize(\"freq\", [\"T\", \"B\"])\n    def test_intersection_empty(self, tz_aware_fixture, freq):\n        # empty same freq GH2129\n        tz = tz_aware_fixture\n        rng = date_range(\"6/1/2000\", \"6/15/2000\", freq=freq, tz=tz)\n        result = rng[0:0].intersection(rng)\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        result = rng.intersection(rng[0:0])\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        # no overlap GH#33604\n        result = rng[:3].intersection(rng[-3:])\n>       tm.assert_index_equal(result, rng[:0])\n\npandas/tests/indexes/datetimes/test_setops.py:289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = DatetimeIndex([], dtype='datetime64[ns]', freq=None)\nr = DatetimeIndex([], dtype='datetime64[ns, UTC]', freq='B'), obj = 'Index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n            assert_class_equal(l, r, exact=exact, obj=obj)\n    \n            # Skip exact dtype checking when `check_categorical` is False\n            if check_categorical:\n>               assert_attr_equal(\"dtype\", l, r, obj=obj)",
        "\npandas/_testing.py:611: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestDatetimeIndexSetOps object at 0x1195a53a0>\ntz_aware_fixture = 'US/Eastern', freq = 'B'\n\n    @pytest.mark.parametrize(\"freq\", [\"T\", \"B\"])\n    def test_intersection_empty(self, tz_aware_fixture, freq):\n        # empty same freq GH2129\n        tz = tz_aware_fixture\n        rng = date_range(\"6/1/2000\", \"6/15/2000\", freq=freq, tz=tz)\n        result = rng[0:0].intersection(rng)\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        result = rng.intersection(rng[0:0])\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        # no overlap GH#33604\n        result = rng[:3].intersection(rng[-3:])\n>       tm.assert_index_equal(result, rng[:0])\n\npandas/tests/indexes/datetimes/test_setops.py:289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = DatetimeIndex([], dtype='datetime64[ns]', freq=None)\nr = DatetimeIndex([], dtype='datetime64[ns, US/Eastern]', freq='B')\nobj = 'Index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n            assert_class_equal(l, r, exact=exact, obj=obj)\n    \n            # Skip exact dtype checking when `check_categorical` is False\n            if check_categorical:\n>               assert_attr_equal(\"dtype\", l, r, obj=obj)",
        "\npandas/_testing.py:611: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestDatetimeIndexSetOps object at 0x11955e940>\ntz_aware_fixture = 'Asia/Tokyo', freq = 'B'\n\n    @pytest.mark.parametrize(\"freq\", [\"T\", \"B\"])\n    def test_intersection_empty(self, tz_aware_fixture, freq):\n        # empty same freq GH2129\n        tz = tz_aware_fixture\n        rng = date_range(\"6/1/2000\", \"6/15/2000\", freq=freq, tz=tz)\n        result = rng[0:0].intersection(rng)\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        result = rng.intersection(rng[0:0])\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        # no overlap GH#33604\n        result = rng[:3].intersection(rng[-3:])\n>       tm.assert_index_equal(result, rng[:0])\n\npandas/tests/indexes/datetimes/test_setops.py:289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = DatetimeIndex([], dtype='datetime64[ns]', freq=None)\nr = DatetimeIndex([], dtype='datetime64[ns, Asia/Tokyo]', freq='B')\nobj = 'Index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n            assert_class_equal(l, r, exact=exact, obj=obj)\n    \n            # Skip exact dtype checking when `check_categorical` is False\n            if check_categorical:\n>               assert_attr_equal(\"dtype\", l, r, obj=obj)",
        "\npandas/_testing.py:611: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestDatetimeIndexSetOps object at 0x1195bd760>\ntz_aware_fixture = 'dateutil/US/Pacific', freq = 'B'\n\n    @pytest.mark.parametrize(\"freq\", [\"T\", \"B\"])\n    def test_intersection_empty(self, tz_aware_fixture, freq):\n        # empty same freq GH2129\n        tz = tz_aware_fixture\n        rng = date_range(\"6/1/2000\", \"6/15/2000\", freq=freq, tz=tz)\n        result = rng[0:0].intersection(rng)\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        result = rng.intersection(rng[0:0])\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        # no overlap GH#33604\n        result = rng[:3].intersection(rng[-3:])\n>       tm.assert_index_equal(result, rng[:0])\n\npandas/tests/indexes/datetimes/test_setops.py:289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = DatetimeIndex([], dtype='datetime64[ns]', freq=None)\nr = DatetimeIndex([], dtype='datetime64[ns, tzfile('/usr/share/zoneinfo/US/Pacific')]', freq='B')\nobj = 'Index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n            assert_class_equal(l, r, exact=exact, obj=obj)\n    \n            # Skip exact dtype checking when `check_categorical` is False\n            if check_categorical:\n>               assert_attr_equal(\"dtype\", l, r, obj=obj)",
        "\npandas/_testing.py:611: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestDatetimeIndexSetOps object at 0x1195b5e50>\ntz_aware_fixture = 'dateutil/Asia/Singapore', freq = 'B'\n\n    @pytest.mark.parametrize(\"freq\", [\"T\", \"B\"])\n    def test_intersection_empty(self, tz_aware_fixture, freq):\n        # empty same freq GH2129\n        tz = tz_aware_fixture\n        rng = date_range(\"6/1/2000\", \"6/15/2000\", freq=freq, tz=tz)\n        result = rng[0:0].intersection(rng)\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        result = rng.intersection(rng[0:0])\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        # no overlap GH#33604\n        result = rng[:3].intersection(rng[-3:])\n>       tm.assert_index_equal(result, rng[:0])\n\npandas/tests/indexes/datetimes/test_setops.py:289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = DatetimeIndex([], dtype='datetime64[ns]', freq=None)\nr = DatetimeIndex([], dtype='datetime64[ns, tzfile('/usr/share/zoneinfo/Asia/Singapore')]', freq='B')\nobj = 'Index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n            assert_class_equal(l, r, exact=exact, obj=obj)\n    \n            # Skip exact dtype checking when `check_categorical` is False\n            if check_categorical:\n>               assert_attr_equal(\"dtype\", l, r, obj=obj)",
        "\npandas/_testing.py:611: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestDatetimeIndexSetOps object at 0x11953ceb0>\ntz_aware_fixture = tzutc(), freq = 'B'\n\n    @pytest.mark.parametrize(\"freq\", [\"T\", \"B\"])\n    def test_intersection_empty(self, tz_aware_fixture, freq):\n        # empty same freq GH2129\n        tz = tz_aware_fixture\n        rng = date_range(\"6/1/2000\", \"6/15/2000\", freq=freq, tz=tz)\n        result = rng[0:0].intersection(rng)\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        result = rng.intersection(rng[0:0])\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        # no overlap GH#33604\n        result = rng[:3].intersection(rng[-3:])\n>       tm.assert_index_equal(result, rng[:0])\n\npandas/tests/indexes/datetimes/test_setops.py:289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = DatetimeIndex([], dtype='datetime64[ns]', freq=None)\nr = DatetimeIndex([], dtype='datetime64[ns, tzutc()]', freq='B'), obj = 'Index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n            assert_class_equal(l, r, exact=exact, obj=obj)\n    \n            # Skip exact dtype checking when `check_categorical` is False\n            if check_categorical:\n>               assert_attr_equal(\"dtype\", l, r, obj=obj)",
        "\npandas/_testing.py:611: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestDatetimeIndexSetOps object at 0x119708700>\ntz_aware_fixture = tzlocal(), freq = 'B'\n\n    @pytest.mark.parametrize(\"freq\", [\"T\", \"B\"])\n    def test_intersection_empty(self, tz_aware_fixture, freq):\n        # empty same freq GH2129\n        tz = tz_aware_fixture\n        rng = date_range(\"6/1/2000\", \"6/15/2000\", freq=freq, tz=tz)\n        result = rng[0:0].intersection(rng)\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        result = rng.intersection(rng[0:0])\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        # no overlap GH#33604\n        result = rng[:3].intersection(rng[-3:])\n>       tm.assert_index_equal(result, rng[:0])\n\npandas/tests/indexes/datetimes/test_setops.py:289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = DatetimeIndex([], dtype='datetime64[ns]', freq=None)\nr = DatetimeIndex([], dtype='datetime64[ns, tzlocal()]', freq='B')\nobj = 'Index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n            assert_class_equal(l, r, exact=exact, obj=obj)\n    \n            # Skip exact dtype checking when `check_categorical` is False\n            if check_categorical:\n>               assert_attr_equal(\"dtype\", l, r, obj=obj)",
        "\npandas/_testing.py:611: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestDatetimeIndexSetOps object at 0x1195d7940>\ntz_aware_fixture = pytz.FixedOffset(300), freq = 'B'\n\n    @pytest.mark.parametrize(\"freq\", [\"T\", \"B\"])\n    def test_intersection_empty(self, tz_aware_fixture, freq):\n        # empty same freq GH2129\n        tz = tz_aware_fixture\n        rng = date_range(\"6/1/2000\", \"6/15/2000\", freq=freq, tz=tz)\n        result = rng[0:0].intersection(rng)\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        result = rng.intersection(rng[0:0])\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        # no overlap GH#33604\n        result = rng[:3].intersection(rng[-3:])\n>       tm.assert_index_equal(result, rng[:0])\n\npandas/tests/indexes/datetimes/test_setops.py:289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = DatetimeIndex([], dtype='datetime64[ns]', freq=None)\nr = DatetimeIndex([], dtype='datetime64[ns, pytz.FixedOffset(300)]', freq='B')\nobj = 'Index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n            assert_class_equal(l, r, exact=exact, obj=obj)\n    \n            # Skip exact dtype checking when `check_categorical` is False\n            if check_categorical:\n>               assert_attr_equal(\"dtype\", l, r, obj=obj)",
        "\npandas/_testing.py:611: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestDatetimeIndexSetOps object at 0x1196669d0>\ntz_aware_fixture = <UTC>, freq = 'B'\n\n    @pytest.mark.parametrize(\"freq\", [\"T\", \"B\"])\n    def test_intersection_empty(self, tz_aware_fixture, freq):\n        # empty same freq GH2129\n        tz = tz_aware_fixture\n        rng = date_range(\"6/1/2000\", \"6/15/2000\", freq=freq, tz=tz)\n        result = rng[0:0].intersection(rng)\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        result = rng.intersection(rng[0:0])\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        # no overlap GH#33604\n        result = rng[:3].intersection(rng[-3:])\n>       tm.assert_index_equal(result, rng[:0])\n\npandas/tests/indexes/datetimes/test_setops.py:289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = DatetimeIndex([], dtype='datetime64[ns]', freq=None)\nr = DatetimeIndex([], dtype='datetime64[ns, UTC]', freq='B'), obj = 'Index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n            assert_class_equal(l, r, exact=exact, obj=obj)\n    \n            # Skip exact dtype checking when `check_categorical` is False\n            if check_categorical:\n>               assert_attr_equal(\"dtype\", l, r, obj=obj)",
        "\npandas/_testing.py:611: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestDatetimeIndexSetOps object at 0x1195c2f40>\ntz_aware_fixture = pytz.FixedOffset(-300), freq = 'B'\n\n    @pytest.mark.parametrize(\"freq\", [\"T\", \"B\"])\n    def test_intersection_empty(self, tz_aware_fixture, freq):\n        # empty same freq GH2129\n        tz = tz_aware_fixture\n        rng = date_range(\"6/1/2000\", \"6/15/2000\", freq=freq, tz=tz)\n        result = rng[0:0].intersection(rng)\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        result = rng.intersection(rng[0:0])\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        # no overlap GH#33604\n        result = rng[:3].intersection(rng[-3:])\n>       tm.assert_index_equal(result, rng[:0])\n\npandas/tests/indexes/datetimes/test_setops.py:289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = DatetimeIndex([], dtype='datetime64[ns]', freq=None)\nr = DatetimeIndex([], dtype='datetime64[ns, pytz.FixedOffset(-300)]', freq='B')\nobj = 'Index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n            assert_class_equal(l, r, exact=exact, obj=obj)\n    \n            # Skip exact dtype checking when `check_categorical` is False\n            if check_categorical:\n>               assert_attr_equal(\"dtype\", l, r, obj=obj)",
        "\npandas/_testing.py:611: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestDatetimeIndexSetOps object at 0x1196558e0>\ntz_aware_fixture = datetime.timezone.utc, freq = 'B'\n\n    @pytest.mark.parametrize(\"freq\", [\"T\", \"B\"])\n    def test_intersection_empty(self, tz_aware_fixture, freq):\n        # empty same freq GH2129\n        tz = tz_aware_fixture\n        rng = date_range(\"6/1/2000\", \"6/15/2000\", freq=freq, tz=tz)\n        result = rng[0:0].intersection(rng)\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        result = rng.intersection(rng[0:0])\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        # no overlap GH#33604\n        result = rng[:3].intersection(rng[-3:])\n>       tm.assert_index_equal(result, rng[:0])\n\npandas/tests/indexes/datetimes/test_setops.py:289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = DatetimeIndex([], dtype='datetime64[ns]', freq=None)\nr = DatetimeIndex([], dtype='datetime64[ns, UTC]', freq='B'), obj = 'Index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n            assert_class_equal(l, r, exact=exact, obj=obj)\n    \n            # Skip exact dtype checking when `check_categorical` is False\n            if check_categorical:\n>               assert_attr_equal(\"dtype\", l, r, obj=obj)",
        "\npandas/_testing.py:611: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestDatetimeIndexSetOps object at 0x11966b9a0>\ntz_aware_fixture = datetime.timezone(datetime.timedelta(seconds=3600))\nfreq = 'B'\n\n    @pytest.mark.parametrize(\"freq\", [\"T\", \"B\"])\n    def test_intersection_empty(self, tz_aware_fixture, freq):\n        # empty same freq GH2129\n        tz = tz_aware_fixture\n        rng = date_range(\"6/1/2000\", \"6/15/2000\", freq=freq, tz=tz)\n        result = rng[0:0].intersection(rng)\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        result = rng.intersection(rng[0:0])\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        # no overlap GH#33604\n        result = rng[:3].intersection(rng[-3:])\n>       tm.assert_index_equal(result, rng[:0])\n\npandas/tests/indexes/datetimes/test_setops.py:289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = DatetimeIndex([], dtype='datetime64[ns]', freq=None)\nr = DatetimeIndex([], dtype='datetime64[ns, UTC+01:00]', freq='B')\nobj = 'Index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n            assert_class_equal(l, r, exact=exact, obj=obj)\n    \n            # Skip exact dtype checking when `check_categorical` is False\n            if check_categorical:\n>               assert_attr_equal(\"dtype\", l, r, obj=obj)",
        "\npandas/_testing.py:611: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestDatetimeIndexSetOps object at 0x11967c8e0>\ntz_aware_fixture = datetime.timezone(datetime.timedelta(days=-1, seconds=82800), 'foo')\nfreq = 'B'\n\n    @pytest.mark.parametrize(\"freq\", [\"T\", \"B\"])\n    def test_intersection_empty(self, tz_aware_fixture, freq):\n        # empty same freq GH2129\n        tz = tz_aware_fixture\n        rng = date_range(\"6/1/2000\", \"6/15/2000\", freq=freq, tz=tz)\n        result = rng[0:0].intersection(rng)\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        result = rng.intersection(rng[0:0])\n        assert len(result) == 0\n        assert result.freq == rng.freq\n    \n        # no overlap GH#33604\n        result = rng[:3].intersection(rng[-3:])\n>       tm.assert_index_equal(result, rng[:0])\n\npandas/tests/indexes/datetimes/test_setops.py:289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = DatetimeIndex([], dtype='datetime64[ns]', freq=None)\nr = DatetimeIndex([], dtype='datetime64[ns, foo]', freq='B'), obj = 'Index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n            assert_class_equal(l, r, exact=exact, obj=obj)\n    \n            # Skip exact dtype checking when `check_categorical` is False\n            if check_categorical:\n>               assert_attr_equal(\"dtype\", l, r, obj=obj)",
        "\npandas/_testing.py:611: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestBusinessDatetimeIndex object at 0x119695a60>\n\n    def test_intersection_bug(self):\n        # GH #771\n        a = bdate_range(\"11/30/2011\", \"12/31/2011\")\n        b = bdate_range(\"12/10/2011\", \"12/20/2011\")\n        result = a.intersection(b)\n        tm.assert_index_equal(result, b)\n>       assert result.freq == b.freq",
        "\npandas/tests/indexes/datetimes/test_setops.py:473: AssertionError"
    ],
    [
        "self = <pandas.tests.indexes.datetimes.test_setops.TestCustomDatetimeIndex object at 0x11955ca60>\n\n    def test_intersection_bug(self):\n        # GH #771\n        a = bdate_range(\"11/30/2011\", \"12/31/2011\", freq=\"C\")\n        b = bdate_range(\"12/10/2011\", \"12/20/2011\", freq=\"C\")\n        result = a.intersection(b)\n        tm.assert_index_equal(result, b)\n>       assert result.freq == b.freq",
        "\npandas/tests/indexes/datetimes/test_setops.py:551: AssertionError"
    ]
]
```
