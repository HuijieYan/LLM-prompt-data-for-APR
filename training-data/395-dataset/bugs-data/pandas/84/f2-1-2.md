# Error stack trace

```json
[
    [
        "self = MultiIndex([('a', 1),\n            ('a', 2),\n            ('a', 3),\n            ('b', 1),\n            ('b', 2),\n        ...('b', 3),\n            ('c', 1),\n            ('c', 2),\n            ('c', 3)],\n           names=[('A', 'a'), ('B', 'b')])\nlevel = 'A'\n\n    def _get_level_number(self, level) -> int:\n        count = self.names.count(level)\n        if (count > 1) and not is_integer(level):\n            raise ValueError(\n                f\"The name {level} occurs multiple times, use a level number\"\n            )\n        try:\n>           level = self.names.index(level)",
        "\npandas/core/indexes/multi.py:1286: ValueError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <pandas.tests.frame.test_reshape.TestDataFrameReshape object at 0x1221f54c0>\n\n    def test_unstack_tuplename_in_multiindex(self):\n        # GH 19966\n        idx = pd.MultiIndex.from_product(\n            [[\"a\", \"b\", \"c\"], [1, 2, 3]], names=[(\"A\", \"a\"), (\"B\", \"b\")]\n        )\n        df = pd.DataFrame({\"d\": [1] * 9, \"e\": [2] * 9}, index=idx)\n>       result = df.unstack((\"A\", \"a\"))\n\npandas/tests/frame/test_reshape.py:345: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \npandas/core/frame.py:6434: in unstack\n    return unstack(self, level, fill_value)\npandas/core/reshape/reshape.py:398: in unstack\n    return _unstack_multiple(obj, level, fill_value=fill_value)\npandas/core/reshape/reshape.py:320: in _unstack_multiple\n    clocs = [index._get_level_number(i) for i in clocs]\npandas/core/reshape/reshape.py:320: in <listcomp>\n    clocs = [index._get_level_number(i) for i in clocs]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MultiIndex([('a', 1),\n            ('a', 2),\n            ('a', 3),\n            ('b', 1),\n            ('b', 2),\n        ...('b', 3),\n            ('c', 1),\n            ('c', 2),\n            ('c', 3)],\n           names=[('A', 'a'), ('B', 'b')])\nlevel = 'A'\n\n    def _get_level_number(self, level) -> int:\n        count = self.names.count(level)\n        if (count > 1) and not is_integer(level):\n            raise ValueError(\n                f\"The name {level} occurs multiple times, use a level number\"\n            )\n        try:\n            level = self.names.index(level)\n        except ValueError:\n            if not is_integer(level):\n>               raise KeyError(f\"Level {level} not found\")",
        "\npandas/core/indexes/multi.py:1289: KeyError"
    ],
    [
        "self = MultiIndex([('a', 1, 3),\n            ('a', 1, 4),\n            ('a', 2, 3),\n            ('a', 2, 4),\n            ('b', ...),\n            ('b', 1, 4),\n            ('b', 2, 3),\n            ('b', 2, 4)],\n           names=[('A', 'a'), 'B', 'C'])\nlevel = 'A'\n\n    def _get_level_number(self, level) -> int:\n        count = self.names.count(level)\n        if (count > 1) and not is_integer(level):\n            raise ValueError(\n                f\"The name {level} occurs multiple times, use a level number\"\n            )\n        try:\n>           level = self.names.index(level)",
        "\npandas/core/indexes/multi.py:1286: ValueError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <pandas.tests.frame.test_reshape.TestDataFrameReshape object at 0x12a9cf850>\nunstack_idx = ('A', 'a')\nexpected_values = [[1, 1, 2, 2], [1, 1, 2, 2], [1, 1, 2, 2], [1, 1, 2, 2]]\nexpected_index = MultiIndex([(1, 3),\n            (1, 4),\n            (2, 3),\n            (2, 4)],\n           names=['B', 'C'])\nexpected_columns = MultiIndex([('d', 'a'),\n            ('d', 'b'),\n            ('e', 'a'),\n            ('e', 'b')],\n           names=[None, ('A', 'a')])\n\n    @pytest.mark.parametrize(\n        \"unstack_idx, expected_values, expected_index, expected_columns\",\n        [\n            (\n                (\"A\", \"a\"),\n                [[1, 1, 2, 2], [1, 1, 2, 2], [1, 1, 2, 2], [1, 1, 2, 2]],\n                pd.MultiIndex.from_tuples(\n                    [(1, 3), (1, 4), (2, 3), (2, 4)], names=[\"B\", \"C\"]\n                ),\n                pd.MultiIndex.from_tuples(\n                    [(\"d\", \"a\"), (\"d\", \"b\"), (\"e\", \"a\"), (\"e\", \"b\")],\n                    names=[None, (\"A\", \"a\")],\n                ),\n            ),\n            (\n                ((\"A\", \"a\"), \"B\"),\n                [[1, 1, 1, 1, 2, 2, 2, 2], [1, 1, 1, 1, 2, 2, 2, 2]],\n                pd.Index([3, 4], name=\"C\"),\n                pd.MultiIndex.from_tuples(\n                    [\n                        (\"d\", \"a\", 1),\n                        (\"d\", \"a\", 2),\n                        (\"d\", \"b\", 1),\n                        (\"d\", \"b\", 2),\n                        (\"e\", \"a\", 1),\n                        (\"e\", \"a\", 2),\n                        (\"e\", \"b\", 1),\n                        (\"e\", \"b\", 2),\n                    ],\n                    names=[None, (\"A\", \"a\"), \"B\"],\n                ),\n            ),\n        ],\n    )\n    def test_unstack_mixed_type_name_in_multiindex(\n        self, unstack_idx, expected_values, expected_index, expected_columns\n    ):\n        # GH 19966\n        idx = pd.MultiIndex.from_product(\n            [[\"a\", \"b\"], [1, 2], [3, 4]], names=[(\"A\", \"a\"), \"B\", \"C\"]\n        )\n        df = pd.DataFrame({\"d\": [1] * 8, \"e\": [2] * 8}, index=idx)\n>       result = df.unstack(unstack_idx)\n\npandas/tests/frame/test_reshape.py:406: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \npandas/core/frame.py:6434: in unstack\n    return unstack(self, level, fill_value)\npandas/core/reshape/reshape.py:398: in unstack\n    return _unstack_multiple(obj, level, fill_value=fill_value)\npandas/core/reshape/reshape.py:320: in _unstack_multiple\n    clocs = [index._get_level_number(i) for i in clocs]\npandas/core/reshape/reshape.py:320: in <listcomp>\n    clocs = [index._get_level_number(i) for i in clocs]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MultiIndex([('a', 1, 3),\n            ('a', 1, 4),\n            ('a', 2, 3),\n            ('a', 2, 4),\n            ('b', ...),\n            ('b', 1, 4),\n            ('b', 2, 3),\n            ('b', 2, 4)],\n           names=[('A', 'a'), 'B', 'C'])\nlevel = 'A'\n\n    def _get_level_number(self, level) -> int:\n        count = self.names.count(level)\n        if (count > 1) and not is_integer(level):\n            raise ValueError(\n                f\"The name {level} occurs multiple times, use a level number\"\n            )\n        try:\n            level = self.names.index(level)\n        except ValueError:\n            if not is_integer(level):\n>               raise KeyError(f\"Level {level} not found\")",
        "\npandas/core/indexes/multi.py:1289: KeyError"
    ]
]
```
