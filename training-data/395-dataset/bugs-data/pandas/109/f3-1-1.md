The issue title is:

```text
set_index on categorical fails with empty partitions
```

The issue title is:

```text
set_index on text column on DataFrame with empty partition throws exception
```
