# Test code

```json
[
    "    def test_margin_normalize(self):\n        # GH 27500\n        df = pd.DataFrame(\n            {\n                \"A\": [\"foo\", \"foo\", \"foo\", \"foo\", \"foo\", \"bar\", \"bar\", \"bar\", \"bar\"],\n                \"B\": [\"one\", \"one\", \"one\", \"two\", \"two\", \"one\", \"one\", \"two\", \"two\"],\n                \"C\": [\n                    \"small\",\n                    \"large\",\n                    \"large\",\n                    \"small\",\n                    \"small\",\n                    \"large\",\n                    \"small\",\n                    \"small\",\n                    \"large\",\n                ],\n                \"D\": [1, 2, 2, 3, 3, 4, 5, 6, 7],\n                \"E\": [2, 4, 5, 5, 6, 6, 8, 9, 9],\n            }\n        )\n        # normalize on index\n        result = pd.crosstab(\n            [df.A, df.B], df.C, margins=True, margins_name=\"Sub-Total\", normalize=0\n        )\n        expected = pd.DataFrame(\n            [[0.5, 0.5], [0.5, 0.5], [0.666667, 0.333333], [0, 1], [0.444444, 0.555556]]\n        )\n        expected.index = MultiIndex(\n            levels=[[\"Sub-Total\", \"bar\", \"foo\"], [\"\", \"one\", \"two\"]],\n            codes=[[1, 1, 2, 2, 0], [1, 2, 1, 2, 0]],\n            names=[\"A\", \"B\"],\n        )\n        expected.columns = Index([\"large\", \"small\"], dtype=\"object\", name=\"C\")\n        tm.assert_frame_equal(result, expected)\n\n        # normalize on columns\n        result = pd.crosstab(\n            [df.A, df.B], df.C, margins=True, margins_name=\"Sub-Total\", normalize=1\n        )\n        expected = pd.DataFrame(\n            [\n                [0.25, 0.2, 0.222222],\n                [0.25, 0.2, 0.222222],\n                [0.5, 0.2, 0.333333],\n                [0, 0.4, 0.222222],\n            ]\n        )\n        expected.columns = Index(\n            [\"large\", \"small\", \"Sub-Total\"], dtype=\"object\", name=\"C\"\n        )\n        expected.index = MultiIndex(\n            levels=[[\"bar\", \"foo\"], [\"one\", \"two\"]],\n            codes=[[0, 0, 1, 1], [0, 1, 0, 1]],\n            names=[\"A\", \"B\"],\n        )\n        tm.assert_frame_equal(result, expected)\n\n        # normalize on both index and column\n        result = pd.crosstab(\n            [df.A, df.B], df.C, margins=True, margins_name=\"Sub-Total\", normalize=True\n        )\n        expected = pd.DataFrame(\n            [\n                [0.111111, 0.111111, 0.222222],\n                [0.111111, 0.111111, 0.222222],\n                [0.222222, 0.111111, 0.333333],\n                [0.000000, 0.222222, 0.222222],\n                [0.444444, 0.555555, 1],\n            ]\n        )\n        expected.columns = Index(\n            [\"large\", \"small\", \"Sub-Total\"], dtype=\"object\", name=\"C\"\n        )\n        expected.index = MultiIndex(\n            levels=[[\"Sub-Total\", \"bar\", \"foo\"], [\"\", \"one\", \"two\"]],\n            codes=[[1, 1, 2, 2, 0], [1, 2, 1, 2, 0]],\n            names=[\"A\", \"B\"],\n        )\n        tm.assert_frame_equal(result, expected)"
]
```
