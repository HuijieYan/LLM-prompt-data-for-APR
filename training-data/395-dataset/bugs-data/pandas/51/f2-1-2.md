# Error stack trace

```json
[
    [
        "n_categories = 5\n\n    @pytest.mark.parametrize(\"n_categories\", [5, 128])\n    def test_categorical_non_unique_monotonic(n_categories):\n        # GH 28189\n        # With n_categories as 5, we test the int8 case is hit in libjoin,\n        # with n_categories as 128 we test the int16 case.\n        left_index = CategoricalIndex([0] + list(range(n_categories)))\n        df1 = DataFrame(range(n_categories + 1), columns=[\"value\"], index=left_index)\n        df2 = DataFrame(\n            [[6]],\n            columns=[\"value\"],\n            index=CategoricalIndex([0], categories=np.arange(n_categories)),\n        )\n    \n        result = merge(df1, df2, how=\"left\", left_index=True, right_index=True)\n        expected = DataFrame(\n            [[i, 6.0] if i < 2 else [i, np.nan] for i in range(n_categories + 1)],\n            columns=[\"value_x\", \"value_y\"],\n            index=left_index,\n        )\n>       tm.assert_frame_equal(expected, result)\n\npandas/tests/reshape/merge/test_merge.py:2187: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = CategoricalIndex([0, 0, 1, 2, 3, 4], categories=[0, 1, 2, 3, 4], ordered=False, dtype='category')\nr = Int64Index([0, 0, 1, 2, 3, 4], dtype='int64'), obj = 'DataFrame.index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n>           assert_class_equal(l, r, exact=exact, obj=obj)",
        "\npandas/_testing.py:623: AssertionError"
    ],
    [
        "n_categories = 128\n\n    @pytest.mark.parametrize(\"n_categories\", [5, 128])\n    def test_categorical_non_unique_monotonic(n_categories):\n        # GH 28189\n        # With n_categories as 5, we test the int8 case is hit in libjoin,\n        # with n_categories as 128 we test the int16 case.\n        left_index = CategoricalIndex([0] + list(range(n_categories)))\n        df1 = DataFrame(range(n_categories + 1), columns=[\"value\"], index=left_index)\n        df2 = DataFrame(\n            [[6]],\n            columns=[\"value\"],\n            index=CategoricalIndex([0], categories=np.arange(n_categories)),\n        )\n    \n        result = merge(df1, df2, how=\"left\", left_index=True, right_index=True)\n        expected = DataFrame(\n            [[i, 6.0] if i < 2 else [i, np.nan] for i in range(n_categories + 1)],\n            columns=[\"value_x\", \"value_y\"],\n            index=left_index,\n        )\n>       tm.assert_frame_equal(expected, result)\n\npandas/tests/reshape/merge/test_merge.py:2187: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nl = CategoricalIndex([  0,   0,   1,   2,   3,   4,   5,   6,   7,   8,\n                  ...\n                  118, 119, ...125, 126, 127],\n                 categories=[0, 1, 2, 3, 4, 5, 6, 7, ...], ordered=False, dtype='category', length=129)\nr = Int64Index([  0,   0,   1,   2,   3,   4,   5,   6,   7,   8,\n            ...\n            118, 119, 120, 121, 122, 123, 124, 125, 126, 127],\n           dtype='int64', length=129)\nobj = 'DataFrame.index'\n\n    def _check_types(l, r, obj=\"Index\"):\n        if exact:\n>           assert_class_equal(l, r, exact=exact, obj=obj)",
        "\npandas/_testing.py:623: AssertionError"
    ]
]
```
