# Test code

```json
[
    "@pytest.mark.parametrize(\"n_categories\", [5, 128])\ndef test_categorical_non_unique_monotonic(n_categories):\n    # GH 28189\n    # With n_categories as 5, we test the int8 case is hit in libjoin,\n    # with n_categories as 128 we test the int16 case.\n    left_index = CategoricalIndex([0] + list(range(n_categories)))\n    df1 = DataFrame(range(n_categories + 1), columns=[\"value\"], index=left_index)\n    df2 = DataFrame(\n        [[6]],\n        columns=[\"value\"],\n        index=CategoricalIndex([0], categories=np.arange(n_categories)),\n    )\n\n    result = merge(df1, df2, how=\"left\", left_index=True, right_index=True)\n    expected = DataFrame(\n        [[i, 6.0] if i < 2 else [i, np.nan] for i in range(n_categories + 1)],\n        columns=[\"value_x\", \"value_y\"],\n        index=left_index,\n    )\n    tm.assert_frame_equal(expected, result)",
    "@pytest.mark.parametrize(\"n_categories\", [5, 128])\ndef test_categorical_non_unique_monotonic(n_categories):\n    # GH 28189\n    # With n_categories as 5, we test the int8 case is hit in libjoin,\n    # with n_categories as 128 we test the int16 case.\n    left_index = CategoricalIndex([0] + list(range(n_categories)))\n    df1 = DataFrame(range(n_categories + 1), columns=[\"value\"], index=left_index)\n    df2 = DataFrame(\n        [[6]],\n        columns=[\"value\"],\n        index=CategoricalIndex([0], categories=np.arange(n_categories)),\n    )\n\n    result = merge(df1, df2, how=\"left\", left_index=True, right_index=True)\n    expected = DataFrame(\n        [[i, 6.0] if i < 2 else [i, np.nan] for i in range(n_categories + 1)],\n        columns=[\"value_x\", \"value_y\"],\n        index=left_index,\n    )\n    tm.assert_frame_equal(expected, result)"
]
```
