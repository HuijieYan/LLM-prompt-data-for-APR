# Test code

```json
[
    "    def test_set_na(self, left_right_dtypes):\n        left, right = left_right_dtypes\n        result = IntervalArray.from_arrays(left, right)\n\n        if result.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                result[0] = np.NaN\n            return\n\n        result[0] = np.nan\n\n        expected_left = Index([left._na_value] + list(left[1:]))\n        expected_right = Index([right._na_value] + list(right[1:]))\n        expected = IntervalArray.from_arrays(expected_left, expected_right)\n\n        tm.assert_extension_array_equal(result, expected)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)",
    "    @pytest.mark.parametrize(\n        \"data, maindtype, answerdict\",\n        [\n            (\n                [1, 2, 3],\n                np.dtype(\"int32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int32\"\n                    ),\n                },\n            ),\n            (\n                [1, 2, 3],\n                np.dtype(\"int64\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"int64\"\n                    ),\n                },\n            ),\n            (\n                [\"x\", \"y\", \"z\"],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [True, False, np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True,),\n                    ): pd.BooleanDtype(),\n                    ((True, False), (True, False), (True, False), (False,)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                [\"h\", \"i\", np.nan],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True,),\n                        (True, False),\n                        (True, False),\n                    ): pd.StringDtype(),\n                    ((True, False), (False,), (True, False), (True, False)): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (  # GH32117\n                [\"h\", \"i\", 1],\n                np.dtype(\"O\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [10, np.nan, 20],\n                np.dtype(\"float\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                },\n            ),\n            (\n                [np.nan, 100.5, 200],\n                np.dtype(\"float\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"float\"),\n                },\n            ),\n            (\n                [3, 4, 5],\n                \"Int8\",\n                {((True, False), (True, False), (True, False), (True, False)): \"Int8\"},\n            ),\n            (\n                [[1, 2], [3, 4], [5]],\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"O\"),\n                },\n            ),\n            (\n                [4, 5, 6],\n                np.dtype(\"uint32\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"UInt32\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"uint32\"\n                    ),\n                },\n            ),\n            (\n                [-10, 12, 13],\n                np.dtype(\"i1\"),\n                {\n                    ((True, False), (True, False), (True,), (True, False)): \"Int8\",\n                    ((True, False), (True, False), (False,), (True, False)): np.dtype(\n                        \"i1\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.0],\n                object,\n                {\n                    ((True,), (True, False), (True,), (True, False)): \"Int64\",\n                    ((True,), (True, False), (False,), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [1, 2.5],\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"float\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False)): np.dtype(\n                        \"object\"\n                    ),\n                },\n            ),\n            (\n                [\"a\", \"b\"],\n                pd.CategoricalDtype(),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.CategoricalDtype(),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                pd.DatetimeTZDtype(tz=\"UTC\"),\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.DatetimeTZDtype(tz=\"UTC\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                \"datetime64[ns]\",\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): np.dtype(\"datetime64[ns]\"),\n                },\n            ),\n            (\n                pd.to_datetime([\"2020-01-14 10:00\", \"2020-01-15 11:11\"]),\n                object,\n                {\n                    ((True,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"datetime64[ns]\"\n                    ),\n                    ((False,), (True, False), (True, False), (True, False),): np.dtype(\n                        \"O\"\n                    ),\n                },\n            ),\n            (\n                pd.period_range(\"1/1/2011\", freq=\"M\", periods=3),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.PeriodDtype(\"M\"),\n                },\n            ),\n            (\n                pd.arrays.IntervalArray([pd.Interval(0, 1), pd.Interval(1, 5)]),\n                None,\n                {\n                    (\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                        (True, False),\n                    ): pd.IntervalDtype(\"int64\"),\n                },\n            ),\n        ],\n    )\n    @pytest.mark.parametrize(\"params\", product(*[(True, False)] * 4))\n    def test_convert_dtypes(self, data, maindtype, params, answerdict):\n        if maindtype is not None:\n            series = pd.Series(data, dtype=maindtype)\n        else:\n            series = pd.Series(data)\n        answers = {k: a for (kk, a) in answerdict.items() for k in product(*kk)}\n\n        ns = series.convert_dtypes(*params)\n        expected_dtype = answers[tuple(params)]\n        expected = pd.Series(series.values, dtype=expected_dtype)\n        tm.assert_series_equal(ns, expected)\n\n        # Test that it is a copy\n        copy = series.copy(deep=True)\n        if is_interval_dtype(ns.dtype) and ns.dtype.subtype.kind in [\"i\", \"u\"]:\n            msg = \"Cannot set float NaN to integer-backed IntervalArray\"\n            with pytest.raises(ValueError, match=msg):\n                ns[ns.notna()] = np.nan\n        else:\n            ns[ns.notna()] = np.nan\n\n        # Make sure original not changed\n        tm.assert_series_equal(series, copy)"
]
```
