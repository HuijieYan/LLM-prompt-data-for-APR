# Corrected function implementation
```python
class FastParquetImpl(BaseImpl):
    def write(self, df, path, compression="snappy", index=None, partition_cols=None, **kwargs):
        self.validate_dataframe(df)
        
        if "partition_on" in kwargs and partition_cols is not None:
            raise ValueError(
                "Cannot use both partition_on and "
                "partition_cols. Use partition_cols for "
                "partitioning data"
            )
        elif "partition_on" in kwargs:
            partition_cols = kwargs.pop("partition_on")
        
        if partition_cols is not None:
            kwargs["file_scheme"] = "hive"
        
        if is_s3_url(path):
            with get_filepath_or_buffer(path, mode="wb") as file:
                self.api.write(
                    file,
                    df,
                    compression=compression,
                    write_index=index,
                    partition_on=partition_cols,
                    **kwargs
                )
        else:
            with get_filepath_or_buffer(path) as file:
                self.api.write(
                    file,
                    df,
                    compression=compression,
                    write_index=index,
                    partition_on=partition_cols,
                    **kwargs
                )
```