# Error stack trace

```json
[
    [
        "keys = ['e', 'f', 'f']\n\n    @pytest.mark.parametrize(\"keys\", [[\"e\", \"f\", \"f\"], [\"f\", \"e\", \"f\"]])\n    def test_duplicate_keys(keys):\n        # GH 33654\n        df = DataFrame({\"a\": [1, 2, 3], \"b\": [4, 5, 6]})\n        s1 = Series([7, 8, 9], name=\"c\")\n        s2 = Series([10, 11, 12], name=\"d\")\n>       result = concat([df, s1, s2], axis=1, keys=keys)\n\npandas/tests/reshape/test_concat.py:2813: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \npandas/core/reshape/concat.py:271: in concat\n    op = _Concatenator(\npandas/core/reshape/concat.py:451: in __init__\n    self.new_axes = self._get_new_axes()\npandas/core/reshape/concat.py:514: in _get_new_axes\n    return [\npandas/core/reshape/concat.py:515: in <listcomp>\n    self._get_concat_axis() if i == self.bm_axis else self._get_comb_axis(i)\npandas/core/reshape/concat.py:571: in _get_concat_axis\n    concat_axis = _make_concat_multiindex(\npandas/core/reshape/concat.py:653: in _make_concat_multiindex\n    return MultiIndex(\npandas/core/indexes/multi.py:283: in __new__\n    result._set_codes(codes, copy=copy, validate=False)\npandas/core/indexes/multi.py:884: in _set_codes\n    new_codes = FrozenList(\npandas/core/indexes/multi.py:885: in <genexpr>\n    _coerce_indexer_frozen(level_codes, lev, copy=copy).view()\npandas/core/indexes/multi.py:3686: in _coerce_indexer_frozen\n    array_like = coerce_indexer_dtype(array_like, categories)\npandas/core/dtypes/cast.py:845: in coerce_indexer_dtype\n    return ensure_int8(indexer)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n>   return arr.astype(np.int8, copy=copy)",
        "\npandas/_libs/algos_common_helper.pxi:61: TypeError"
    ],
    [
        "keys = ['f', 'e', 'f']\n\n    @pytest.mark.parametrize(\"keys\", [[\"e\", \"f\", \"f\"], [\"f\", \"e\", \"f\"]])\n    def test_duplicate_keys(keys):\n        # GH 33654\n        df = DataFrame({\"a\": [1, 2, 3], \"b\": [4, 5, 6]})\n        s1 = Series([7, 8, 9], name=\"c\")\n        s2 = Series([10, 11, 12], name=\"d\")\n>       result = concat([df, s1, s2], axis=1, keys=keys)\n\npandas/tests/reshape/test_concat.py:2813: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \npandas/core/reshape/concat.py:284: in concat\n    return op.get_result()\npandas/core/reshape/concat.py:497: in get_result\n    new_data = concatenate_block_managers(\npandas/core/internals/concat.py:84: in concatenate_block_managers\n    return BlockManager(blocks, axes)\npandas/core/internals/managers.py:136: in __init__\n    self._verify_integrity()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[ValueError('all arrays must be same length') raised in repr()] BlockManager object at 0x11dfcc6a0>\n\n    def _verify_integrity(self) -> None:\n        mgr_shape = self.shape\n        tot_items = sum(len(x.mgr_locs) for x in self.blocks)\n        for block in self.blocks:\n            if block._verify_integrity and block.shape[1:] != mgr_shape[1:]:\n                raise construction_error(tot_items, block.shape[1:], self.axes)\n        if len(self.items) != tot_items:\n>           raise AssertionError(\n                \"Number of manager items must equal union of \"\n                f\"block items\\n# manager items: {len(self.items)}, # \"\n                f\"tot_items: {tot_items}\"\n            )",
        "\npandas/core/internals/managers.py:323: AssertionError"
    ]
]
```
