```python
    def gen_python_files_in_dir(
        path: Path,
        root: Path,
        include: Pattern[str],
        exclude: Pattern[str],
        report: "Report",
    ) -> Iterator[Path]:
        """Generate all files under `path` whose paths are not excluded by the
        `exclude` regex, but are included by the `include` regex.
    
        `report` is where output about exclusions goes.
        """

        def is_path_within_root(check_path: Path, root_path: Path) -> bool:
            if check_path.is_absolute():
                return check_path.parts[: len(root_path.parts)] == root_path.parts
            return check_path.parts == root_path.parts

        for child in path.iterdir():
            if not is_path_within_root(child.resolve(), root):
                continue  # Skip any paths outside of the root directory

            normalized_path = child.relative_to(root)
                
            if child.is_dir():
                normalized_path /= ""  # Add a "/" suffix to denote it is a directory
                yield from gen_python_files_in_dir(child, root, include, exclude, report)
            elif child.is_file():
                normalized_path_str = normalized_path.as_posix()
                if exclude.search(normalized_path_str) is not None:
                    report.path_ignored(child, f"matches the --exclude regular expression")
                    continue
                if include.search(normalized_path_str):
                    yield child
```