<?xml version="1.0" encoding="utf-8"?><testsuites><testsuite errors="0" failures="1" hostname="boyudeMacBook-Pro.local" name="pytest" skipped="0" tests="2" time="0.311" timestamp="2023-11-15T22:42:44.351625"><testcase classname="pandas.tests.window.test_grouper.TestGrouperGrouping" name="test_groupby_rolling[1.0-True]" time="0.019"><failure message="AssertionError: Series are different

Series values are different (100.0 %)
[left]:  [0.0, 0.0, 0.0]
[right]: [1.0, 1.0, 1.0]">self = &lt;pandas.tests.window.test_grouper.TestGrouperGrouping object at 0x121f05850&gt;
expected_value = 1.0, raw_value = True

    @pytest.mark.parametrize(&quot;expected_value,raw_value&quot;, [[1.0, True], [0.0, False]])
    def test_groupby_rolling(self, expected_value, raw_value):
        # GH 31754
    
        def foo(x):
            return int(isinstance(x, np.ndarray))
    
        df = pd.DataFrame({&quot;id&quot;: [1, 1, 1], &quot;value&quot;: [1, 2, 3]})
        result = df.groupby(&quot;id&quot;).value.rolling(1).apply(foo, raw=raw_value)
        expected = Series(
            [expected_value] * 3,
            index=pd.MultiIndex.from_tuples(
                ((1, 0), (1, 1), (1, 2)), names=[&quot;id&quot;, None]
            ),
            name=&quot;value&quot;,
        )
&gt;       tm.assert_series_equal(result, expected)

pandas/tests/window/test_grouper.py:210: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
pandas/_libs/testing.pyx:65: in pandas._libs.testing.assert_almost_equal
    cpdef assert_almost_equal(a, b,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

&gt;   raise_assert_detail(obj, msg, lobj, robj)
E   AssertionError: Series are different
E   
E   Series values are different (100.0 %)
E   [left]:  [0.0, 0.0, 0.0]
E   [right]: [1.0, 1.0, 1.0]

pandas/_libs/testing.pyx:174: AssertionError</failure></testcase><testcase classname="pandas.tests.window.test_grouper.TestGrouperGrouping" name="test_groupby_rolling[0.0-False]" time="0.014"></testcase></testsuite></testsuites>