The bug in the `_get_with` function seems to be related to the handling of the `key` parameter when it is of different types. The function is failing to correctly handle certain types of keys, leading to the KeyError in the failing tests.

The bug seems to occur due to the incorrect inference of the `key_type` and the subsequent incorrect handling based on the inferred type. The issue arises when a key of type 'string' is encountered, the function is unable to handle it properly.

To fix the bug, one possible strategy is to explicitly check for the type of the `key` parameter and handle each type separately. Additionally, the type inference logic needs to be fixed to correctly identify the type of the key.

Here's the corrected version of the `_get_with` function:

```python
def _get_with(self, key):
    if isinstance(key, slice):
        slobj = self.index._convert_slice_indexer(key, kind="getitem")
        return self._slice(slobj)
    elif isinstance(key, ABCDataFrame):
        raise TypeError(
            "Indexing a Series with DataFrame is not supported, use the appropriate DataFrame column"
        )
    elif isinstance(key, tuple):
        return self._get_values_tuple(key)

    if not is_list_like(key):
        return self.loc[key]

    if isinstance(key, (list, np.ndarray, ExtensionArray, Series, Index)):
        if isinstance(key, Index):
            key_type = key.inferred_type
        elif isinstance(key, (pd.Series, np.ndarray)):
            key_type = 'integer' if key.dtype.kind in 'iuf' else 'string'
        else:
            key_type = lib.infer_dtype(key, skipna=False)
        
        if key_type == "integer":
            if not self.index._should_fallback_to_positional():
                return self.loc[key]
            else:
                return self.iloc[key]

        if isinstance(key, list):
            return self.loc[key]

        return self.reindex(key)
```

In the corrected version, the key type is explicitly handled based on its actual type. Additionally, for lists, arrays, and other key types, the `inferred_type` is correctly restructured to handle integer and string types separately.

By implementing this correction, the `_get_with` function should now pass the failing test.