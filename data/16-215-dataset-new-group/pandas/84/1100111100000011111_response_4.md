```python
from pandas.core.indexes.api import Index, MultiIndex
from pandas.core.series import Series
from pandas.core.sorting import compress_group_index, decons_obs_group_ids, get_compressed_ids, get_group_index

def unstack(obj, level, fill_value=None):
    # Function body goes here

def _unstack_multiple(data, clocs, fill_value=None):
    if len(clocs) == 0:
        return data
    
    index = data.index
    all_levels = index.levels
    all_codes = index.codes
    all_names = index.names
    
    # Updated code for finding rlocs to handle hierarchical columns
    rlocs = [i for i, level in enumerate(index.levels) if not level.name in clocs]
    
    clevels = [all_levels[i] for i in clocs]
    ccodes = [all_codes[i] for i in clocs]
    cnames = [all_names[i] for i in clocs]
    rlevels = [all_levels[i] for i in rlocs]
    rcodes = [all_codes[i] for i in rlocs]
    rnames = [all_names[i] for i in rlocs]
    
    # Rest of the code for the function remains as is
    # ...
    # ...

```