```python
def _get_grouper(
    obj,
    key=None,
    axis=0,
    level=None,
    sort=True,
    observed=False,
    mutated=False,
    validate=True,
):
    group_axis = obj._get_axis(axis)

    if level is not None:
        if isinstance(group_axis, MultiIndex):
            if is_list_like(level) and len(level) == 1:
                level = level[0]

            if key is None and is_scalar(level):
                key = group_axis.get_level_values(level)
                level = None

        else:
            if is_list_like(level):
                nlevels = len(level)
                if nlevels == 1:
                    level = level[0]
                elif nlevels == 0:
                    raise ValueError("No group keys passed!")
                else:
                    raise ValueError("multiple levels only valid with MultiIndex")

            if obj.index.name != level and isin(level, obj.columns):
                key = obj[level]
                level = None
            else:
                raise ValueError(f"level name {level} is not the name of the index or a column")

    if isinstance(key, Grouper):
        binner, grouper, obj = key._get_grouper(obj, validate=False)
        return (grouper, {key.key}, obj) if key.key is not None else (grouper, [], obj)

    elif isinstance(key, BaseGrouper):
        return (key, [], obj)

    if is_scalar(key):
        key = [key]
    elif not is_list_like(key):
        key = list(key)

    if len(key) == len(group_axis):
        if isinstance(obj, DataFrame):
            if any(k not in obj.columns for k in key):
                raise KeyError(f"key {key} not found in dataframe columns")
        else:
            if any(k != obj.index.name for k in key):
                raise KeyError(f"key {key} not found in index name")

    groupings = []
    exclusions = []

    for gpr in key:
        level = None

        if gpr in obj.columns:
            exclusions.append(gpr)
            key = obj[gpr]
            in_axis = True
        elif gpr in obj.index:
            if validate:
                obj._check_label_or_level_ambiguity(gpr)
                exclusions.append(gpr)
            level = group_axis.freq.grouper(level=gpr)
            in_axis = False
        else:
            raise KeyError(gpr)

        if is_categorical_dtype(key) and len(key) != obj.shape[axis]:
            raise ValueError(f"Length of grouper ({len(key)}) and axis ({obj.shape[axis]}) must be same length")

        groupings.append(
            Grouping(
                group_axis,
                key,
                level,
                gpr,
                sort,
                observed,
                in_axis,
            )
        )

    if not groupings and len(obj):
        raise ValueError("No group keys passed!")

    return BaseGrouper(group_axis, groupings, sort=sort, mutated=mutated), exclusions, obj
```