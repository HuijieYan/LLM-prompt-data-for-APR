Based on the provided code and the GitHub issue, the buggy function `apply` is not handling the holidays correctly when using periods and adding holidays. This leads to more than the expected number of periods.

To fix the bug, the `apply` function needs to be modified to properly handle the holidays in the calculation of business hours. This can be achieved by adjusting the logic to account for holidays when calculating the number of business days, and when adjusting the remaining business hours.

Here's the corrected version of the `apply` function:

```python
from pandas.tseries.offsets import BusinessDay

@apply_wraps
def apply(self, other):
    if isinstance(other, datetime):
        # ... (rest of the function)
        
        # adjust by business days first
        if bd != 0:
            skip_bd = BusinessDay(n=bd, holidays=self.holidays)  # include holidays in the calculation
            other = other + skip_bd

        # remaining business hours to adjust
        bhour_remain = timedelta(minutes=r)

        # handle remaining business hours with respect to holidays
        while bhour_remain != timedelta(0):
            holiday = next((h for h in self.holidays if h > other), None)
            if holiday and holiday < self._next_opening_time(other + bhour_remain):
                # If a holiday falls within the remaining business hours, move to the next opening time
                other = self._next_opening_time(holiday)
            else:
                # business hour left in this business time interval
                bhour = self._next_opening_time(other) - other
                if bhour_remain < bhour:
                    # finish adjusting if possible
                    other += bhour_remain
                    bhour_remain = timedelta(0)
                else:
                    # go to next business time interval
                    bhour_remain -= bhour
                    other = self._get_closing_time(
                        self._next_opening_time(other + bhour - timedelta(seconds=1))
                    )

        return other
    else:
        raise ApplyTypeError("Only know how to combine business hour with datetime")
```

This corrected version includes adjustments for handling holidays when calculating the number of business days and when adjusting the remaining business hours. These changes are aligned with the fix strategy suggested earlier.

With this correction, the function should now properly handle the calculation of business hours and holidays, fixing the bug identified in the GitHub issue.