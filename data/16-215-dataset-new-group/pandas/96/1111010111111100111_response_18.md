The bug in the `apply` function is causing the `CustomBusinessHour` frequency to produce more periods than expected when holidays are added. The `apply` function is not correctly adjusting the next opening time when the number of business hours is negative. This results in an incorrect calculation of remaining business hours to adjust, leading to the generation of more periods than expected.

The bug is due to the incorrect adjustment of the next opening time and the miscalculation of remaining business hours when the number of business hours is negative.

One strategy to fix the bug is to refactor the logic for adjusting the next opening time and calculating the remaining business hours when the number of business hours is negative.

Here's the corrected version of the `apply` function:

```python
def apply(self, other):
    if isinstance(other, datetime):
        n = self.n
        nanosecond = getattr(other, "nanosecond", 0)

        if n >= 0:
            if other.time() in self.end or not self._is_on_offset(other):
                other = self._next_opening_time(other)
        else:
            if other.time() in self.start:
                # adjustment to move to previous business day
                other = other - timedelta(seconds=1)
            if not self._is_on_offset(other):
                other = self._next_opening_time(other)
                other = self._get_closing_time(other)

        # Calculate remaining business hours
        businesshours = sum(self._get_business_hours_by_sec(st, en) for st, en in zip(self.start, self.end))
        remaining_hours = abs(n) * 60 * 60
        if n < 0:
            remaining_hours = -remaining_hours

        if remaining_hours:
            next_interval = self._next_opening_time(other)

            while remaining_hours > 0:
                bhour = self._get_closing_time(next_interval) - other if n >= 0 else next_interval - other

                if remaining_hours < bhour.seconds:
                    other += timedelta(seconds=remaining_hours)
                    remaining_hours = 0
                else:
                    remaining_hours -= bhour.seconds
                    other = self._next_opening_time(other + bhour)

        return other
    else:
        raise ApplyTypeError("Only know how to combine business hour with datetime")
``` 

With this correction, the `apply` function should now produce the expected number of periods with added holidays for the `CustomBusinessHour` frequency.