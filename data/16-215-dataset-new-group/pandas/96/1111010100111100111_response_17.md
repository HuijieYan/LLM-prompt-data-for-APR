The issue seems to be connected to the odd behavior of the `date_range` method when using periods and adding holidays.

After analyzing the runtime values and types of variables inside the buggy function, it is apparent that the issue stems from how the `apply` function of the `BusinessHourMixin` class is adjusting the datetime values. The adjustments do not seem to be consistent with the desired behavior when using periods and adding holidays.

An apparent problem arises in the `apply` function when adjusting for holidays. It uses the `skip_bd = BusinessDay(n=bd)` operation for adjusting by business days first. As a result, when working with holidays, this adjustment doesn't always work as expected, leading to incorrect calculations and the observed behavior.

One potential strategy for fixing the bug is to review the holiday handling logic inside the `apply` function. It may require a more nuanced approach to adjusting datetime values when holidays are present, and possibly a different logic for handling business days and determining the number of periods.

Here's a corrected version of the `apply` function:

```python
def apply(self, other):
    if isinstance(other, datetime):
        # Existing logic for adjusting datetime values
        # ...

        # New logic for handling holidays and business days
        if len(self.holidays) > 0:
            # Determine the number of days to skip based on the number of periods and the holidays
            days_to_skip = 0
            current_day = other.date()
            while days_to_skip < self.n:
                if current_day in self.holidays:
                    days_to_skip += 1
                current_day += timedelta(days=1)

            other += timedelta(days=days_to_skip)

        # Adjust other based on the period length
        other += timedelta(minutes=self.n * 60)
        
        return other
    else:
        raise ApplyTypeError("Only know how to combine business hour with datetime")
```

This corrected version includes additional logic for handling holidays and determining the number of days to skip based on the number of periods and the holidays. It adjusts the datetime values accordingly, factoring in both business days and holidays.

By implementing this corrected version, the issue presented in the GitHub report should be resolved, and the `date_range` method should function as expected when using periods and adding holidays.