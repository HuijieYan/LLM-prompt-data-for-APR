The issue seems to be related to using holidays with CustomBusinessHour. The function `apply` in the `BusinessHourMixin` class is involved in this bug. It seems to be incorrectly calculating and adjusting business hours, which leads to the incorrect output of the`pd.date_range` function.

The problem appears to be with the logic for adjusting business hours in the `apply` function. It incorrectly handles the calculations to account for working days and remaining business hours, causing the produced date range to be incorrect.

The bug can be fixed by revisiting the logic in the `apply` function to ensure that it correctly handles the adjustments for working hours and holidays. The adjustments for the business days and remaining business hours should be carefully calculated to produce the correct output when combined with the `pd.date_range` function.

Here's a corrected version of the `apply` function:

```python
@apply_wraps
def apply(self, other):
    if isinstance(other, datetime):
        is_datetime_index = getattr(other, "freqstr", None) is not None

        if is_datetime_index:
            other = as_datetime(other)  # Convert the Timestamp to a datetime object

        other = as_datetime(other)

        adjusted_time = self._adjust_time(other)

        if is_datetime_index:
            return adjusted_time

        dt = other + timedelta(minutes=self.n * 60)

        if not self.on_offset(dt):
            return self.rollforward(dt)  # Forward roll the calculated datetime

        return dt
    else:
        raise ApplyTypeError("Only know how to combine business hour with datetime")
```

This corrected version should handle the adjustments for business hours and holidays more accurately, ensuring that `pd.date_range` produces the expected output.