The cause of the bug in the `apply` function is due to the incorrect adjustment of holidays and business hours which results in more periods than expected in the failing test.

To fix this bug, the adjustments for holidays and business hours need to be handled correctly. It seems that the adjustments for business days and remaining business hours have issues. The code should be refactored to ensure correct adjustment for business days and business hours, considering the working hours and the presence of holidays.

The corrected version of the `apply` function is as follows:

```python
@apply_wraps
def apply(self, other):
    if isinstance(other, datetime):
        # Check for holidays
        if other in self.holidays:
            other = self._next_opening_time(other)

        n = self.n

        # get total business hours by sec in one business day
        businesshours = sum(
            self._get_business_hours_by_sec(st, en)
            for st, en in zip(self.start, self.end)
        )

        bd, r = divmod(abs(n * 60), businesshours // 60)
        if n < 0:
            bd, r = -bd, -r

        if bd != 0:
            # adjust by business days first
            if bd > 0:
                other = self._next_opening_time(self._last_closing_time(other) + timedelta(days=1))
            elif bd < 0:
                other = self._prev_opening_time(self._first_opening_time(other) - timedelta(days=1))

        # remaining business hours to adjust
        bhour_remain = timedelta(minutes=r)

        if n >= 0:
            while bhour_remain >= timedelta(0):
                # business hour left in this business time interval
                next_opening_time = self._next_opening_time(other)
                bhour = next_opening_time - other

                if bhour_remain <= bhour or (bhour_remain == timedelta(0) and self._is_on_offset(other)):
                    # finish adjusting if possible
                    other += bhour_remain
                    bhour_remain = timedelta(0)
                    break
                else:
                    # go to next business time interval
                    bhour_remain -= bhour
                    other = next_opening_time
        else:
            while bhour_remain != timedelta(0):
                # business hour left in this business time interval
                next_closing_time = self._get_closing_time(other)
                bhour = next_closing_time - other

                if bhour_remain >= bhour:
                    # finish adjusting if possible
                    other += bhour_remain
                    bhour_remain = timedelta(0)
                    break
                else:
                    # go to next business time interval
                    bhour_remain -= bhour
                    other = self._next_opening_time(next_closing_time)

        return other
    else:
        raise ApplyTypeError("Only know how to combine business hour with datetime")
```

By making the adjustments suggested above, the corrected `apply` function should now correctly handle holidays, business days, and business hours, resolving the issue reported in GitHub.