The bug in the function arises from the incorrect condition for converting images in the PNG format with RGBA mode to RGB mode. Additionally, the function fails to properly handle the resizing of images when a 'size' parameter is provided.

To fix the bug:
1. Modify the condition for converting images in PNG format with RGBA mode to RGB mode.
2. Add a condition to handle the resizing of images when a 'size' parameter is provided.

Here's the corrected version of the function:

```python
# The relative path of the corrected file: scrapy/pipelines/images.py

def convert_image(self, image, size=None):
    if image.format == 'PNG' and image.mode == 'RGBA':
        image = image.convert('RGB')
    elif image.mode != 'RGB':
        image = image.convert('RGB')

    if size:
        image = image.resize(size, Image.ANTIALIAS)

    buf = BytesIO()
    image.save(buf, 'JPEG')
    return image, buf
```

This corrected version should satisfy all the expected input/output values for the given test cases.