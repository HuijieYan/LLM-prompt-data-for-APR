The bug is in the `_dict_arg` function of the `SparkSubmitTask` class in the `luigi/contrib/spark.py` file. The error occurs when comparing lists from the `proc` argument in the test functions.

The cause of the bug stems from the `_dict_arg` function while appending values to the list without properly converting them to strings. This results in incorrect comparisons in the test cases because some of the items in the lists are represented as string literals while others are not.

To fix the bug, the `value` from the dictionary also needs to be wrapped with double quotes to ensure that all items in the list are being consistently compared as strings.

Here's a corrected version of the `_dict_arg` function:

```python
def _dict_arg(self, name, value):
    command = []
    if value and isinstance(value, dict):
        for prop, item in value.items():
            command += [name, '"{0}={1}"'.format(prop, item)]
    return command
```