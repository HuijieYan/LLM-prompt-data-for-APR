The function `_dict_arg` in `luigi/contrib/spark.py` is causing the failing tests. The error messages indicate that the function is not handling dict arguments properly. The issue arises when converting dictionary items into a list of command arguments. The values from the dictionary are being wrapped in double-quotes, even when they are not supposed to be.

To fix this bug, we need to modify the `_dict_arg` function to properly handle dictionary arguments. 

Here's a corrected version of the `_dict_arg` function:

```python
def _dict_arg(self, name, value):
    command = []
    if value and isinstance(value, dict):
        for prop, val in value.items():
            cmd_template = '{0}={1}' if isinstance(val, str) else '"{0}={1}"'
            command += [name, cmd_template.format(prop, val)]
    return command
```

With this modification, the double quotes will be added only when necessary, i.e., when the value is a string. This should resolve the issue and make the failing tests pass.