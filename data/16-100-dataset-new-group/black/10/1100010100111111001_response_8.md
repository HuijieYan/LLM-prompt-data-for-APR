The function `_partially_consume_prefix` has a bug where it does not properly handle the indentation level when waiting for a new line. This results in incorrect behavior when comparing formatted strings in the failing test.

The cause of the bug is that the function does not correctly update the `current_column` variable when a new line is encountered. This causes the function to get into an incorrect state when processing subsequent characters, leading to incorrect output and failing test cases.

To fix the bug, the function needs to properly update the `current_column` variable when a new line is encountered, and reset it to 0. This ensures that the function correctly tracks the column position within the prefix string.

Here's the corrected version of the function:

```python
def _partially_consume_prefix(self, prefix, column):
    lines = []
    current_line = ""
    current_column = 0
    wait_for_nl = False
    for char in prefix:
        current_line += char
        if wait_for_nl:
            if char == '\n':
                if current_line.strip() and current_column < column:
                    res = ''.join(lines)
                    return res, prefix[len(res):]

                lines.append(current_line)
                current_line = ""
                current_column = 0
                wait_for_nl = False
            else:
                current_column += 1
        elif char == ' ':
            current_column += 1
        elif char == '\t':
            current_column += 4
        elif char == '\n':
            current_column = 0
        else:
            wait_for_nl = True
    return ''.join(lines), current_line
```

This corrected version of the function should now pass the failing test and satisfy the expected input/output values.