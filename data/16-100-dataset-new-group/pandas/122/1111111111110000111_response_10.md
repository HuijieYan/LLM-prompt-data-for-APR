The cause of the bug in the `equals` function is that it is not properly comparing the data frames `df1` and `df2` for equality. The functions `self._consolidate_inplace()` and `other._consolidate_inplace()` are trying to consolidate the blocks in the data frames, but they are not comparing the actual content of the data frames correctly.

To fix the bug, the `equals` function needs to compare the content of the data frames directly, instead of comparing the internal data structures.

Here's the corrected version of the `equals` function:

```python
def equals(self, other):
    return self.values.equals(other.values)
```

In the corrected version, the `equals` function directly compares the values of the data frames (accessed via the `values` attribute) for equality.

By making this change, the `equals` function will correctly compare the content of the data frames `df1` and `df2`, and the test `assert df1.equals(df2) is False` will pass.