The bug in the `equals` function causes the test `test_dataframe_not_equal` to fail. The bug is likely related to how the function compares the `blocks` of two `BlockManager` instances. The comparison seems to be based on the order of blocks rather than their actual content.

To fix the bug:
1. We need to ensure that the comparison of `blocks` is based on their content rather than their order.
2. We also need to remove the unnecessary consolidation of the `BlockManager` instances.

Below is the corrected version of the `equals` function:

```python
def equals(self, other):
    self_axes, other_axes = self.axes, other.axes
    if len(self_axes) != len(other_axes):
        return False
    if not all(ax1.equals(ax2) for ax1, ax2 in zip(self_axes, other_axes)):
        return False

    # Compare all blocks in the BlockManager
    for self_block in self.blocks:
        block_found = False
        for other_block in other.blocks:
            if self_block.equals(other_block):
                block_found = True
                break
        if not block_found:
            return False

    return True
```

The corrected version ensures that the comparison of `blocks` is based on their content rather than their order, resolving the issue described in the GitHub report. This version should now pass the failing test `test_dataframe_not_equal`.