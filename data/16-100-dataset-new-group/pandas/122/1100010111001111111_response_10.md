The buggy `equals` function in the `managers.py` file is causing the failing test `test_dataframe_not_equal` in `test_internals.py`.

The bug in the `equals` function is likely caused by the faulty comparison of blocks in the `self_blocks` and `other_blocks` variables. This comparison is based on the ordering of the blocks, which may not accurately represent the equality of the DataFrames. Additionally, the function is not comparing the values inside the blocks, leading to incorrect results.

To fix the bug, the comparison of blocks needs to be modified to accurately check for equality of the DataFrames.

Here's the corrected version of the `equals` function:

```python
def equals(self, other):
    self_axes, other_axes = self.axes, other.axes
    if len(self_axes) != len(other_axes):
        return False
    if not all(ax1.equals(ax2) for ax1, ax2 in zip(self_axes, other_axes)):
        return False
    self._consolidate_inplace()
    other._consolidate_inplace()
    if len(self.blocks) != len(other.blocks):
        return False

    for i, (block, oblock) in enumerate(zip(self.blocks, other.blocks)):
        if not block.equals(oblock):
            return False
        elif not block.values.equals(oblock.values):
            return False

    return True
```

In the corrected version, we iterate over the blocks and compare both the structure and the values inside the blocks. This ensures a more accurate comparison of the DataFrames.

With this correction, the `equals` function should now return the expected results for the failing test, and it should also resolve the issue reported on GitHub.