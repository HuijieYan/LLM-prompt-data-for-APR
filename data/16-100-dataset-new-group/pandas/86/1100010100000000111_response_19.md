## Analysis
The GitHub issue points out that the error message raised when columns=None in df.pivot is confusing. The issue suggests that the error message should indicate that columns is not optional, as per the docstring.

## Potential error locations
1. The condition for checking if columns is None.
2. The error message raised when columns is None.

## Cause of the bug
The bug is caused by the confusion in the error message when columns is None. The function fails to handle the case where columns is None and raises a confusing error message.

## Strategy for fixing the bug
To fix the bug, we need to modify the condition for checking if columns is None and update the error message to correctly indicate that columns is not optional.

## Corrected Version
```python
@Substitution("\ndata : DataFrame")
@Appender(_shared_docs["pivot"], indents=1)
def pivot(data: "DataFrame", index=None, columns=None, values=None) -> "DataFrame":
    if columns is None:  # Updated condition to check if columns is None
        raise ValueError("columns is not optional")
    if values is None:
        cols = [columns] if index is None else [index, columns]
        append = index is None
        indexed = data.set_index(cols, append=append)
    else:
        if index is None:
            index = data.index
        else:
            index = data[index]
        index = MultiIndex.from_arrays([index, data[columns]])

        if is_list_like(values) and not isinstance(values, tuple):
            # Exclude tuple because it is seen as a single column name
            indexed = data._constructor(
                data[values].values, index=index, columns=values
            )
        else:
            indexed = data._constructor_sliced(data[values].values, index=index)
    return indexed.unstack(columns)
```