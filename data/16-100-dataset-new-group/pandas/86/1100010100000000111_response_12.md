The bug in the function is causing a KeyError to be raised when the columns parameter is set to None in the pivot function. The bug is related to the incorrect handling of the columns parameter and the erroneous error message that is being raised.

To fix this bug, the function needs to be modified to explicitly handle the case when the columns parameter is None, and also the error message should be updated to clearly indicate that columns is not optional.

Here is the corrected version of the function:

```python
@Substitution("\ndata : DataFrame")
@Appender(_shared_docs["pivot"], indents=1)
def pivot(data: "DataFrame", index=None, columns=None, values=None) -> "DataFrame":
    if columns is None:  # explicit handling of columns=None case
        raise ValueError("Columns is not optional")

    if values is None:
        cols = [columns] if index is None else [index, columns]
        append = index is None
        indexed = data.set_index(cols, append=append)
    else:
        if index is None:
            index = data.index
        else:
            index = data[index]
        index = MultiIndex.from_arrays([index, data[columns]])

        if is_list_like(values) and not isinstance(values, tuple):
            # Exclude tuple because it is seen as a single column name
            indexed = data._constructor(
                data[values].values, index=index, columns=values
            )
        else:
            indexed = data._constructor_sliced(data[values].values, index=index)
    return indexed.unstack(columns)
```

With this corrected version, the function now explicitly checks for columns being None and raises a ValueError with a clear message. This aligns the behavior with the expectations in the documentation and resolves the issue reported on GitHub.