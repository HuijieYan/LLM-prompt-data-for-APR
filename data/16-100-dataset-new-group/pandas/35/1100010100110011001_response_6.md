### Analysis
The error message indicates that the function is trying to access an attribute of a `NoneType` object, which means that `self._engine_type(period, len(self))` is returning `None` instead of the expected object.

### Bug
The bug is likely in the function `_engine_type()` since it is returning `None` instead of the expected object.

### Fix Strategy
The `_engine_type()` function should be checked to ensure that it returns the correct object and does not return `None`.

### The corrected version
```python
@cache_readonly
def _engine(self):
    # To avoid a reference cycle, pass a weakref of self to _engine_type.
    period = weakref.ref(self)
    engine = self._engine_type(period, len(self))
    if engine is None:
        raise ValueError("Engine type returned None")
    return engine
```