The bug in the `table_exists` function is that it does not properly handle the case where the `run_hive_cmd` function returns empty string. Additionally, there is also a problem with formatting the Hive command in the else block of the function.

The `table_exists` function should return `False` if the `run_hive_cmd` returns an empty string, which indicates the table does not exist. The correct strategy to fix the bug is to add a check for an empty stdout and return `False` in that case.

Here's the corrected version of the `table_exists` function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))
        
        return stdout and table in stdout
    else:
        partition_command = self.partition_spec(partition)
        if partition_command:
            stdout = run_hive_cmd("use {0}; show partitions {1} partition ({2})".format(database, table, partition_command))
            return bool(stdout)
        else:
            return False
```

In this corrected version, there's an additional check for `partition_command` to ensure that it's not empty before running the Hive command for partitioned tables. The `bool(stdout)` ensures that the function returns `True` if the `run_hive_cmd` returns any non-empty output.

With this correction, the failing tests should now pass.