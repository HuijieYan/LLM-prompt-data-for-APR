The bug in the `table_exists` function seems to be caused by the comparison between the `table` and `stdout` variables. In the first if-else block, the comparison `table in stdout` is failing to check the presence of the table name in the `stdout`. 

Additionally, in the second if-else block, the stdout is expected to contain the table name, but the current implementation is not checking for that condition.

To fix this issue, the function should be modified to check for the presence of the table name in the `stdout` for both cases, and return `True` if the table exists, and `False` otherwise.

Here's a corrected version of the function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))
        return table in stdout
    else:
        # Added condition to check for the presence of table name in stdout
        stdout = run_hive_cmd("""use %s; show partitions %s partition
                        (%s)""" % (database, table, self.partition_spec(partition)))
        return table in stdout
```

This corrected version of the function compares the `table` variable with the `stdout` and returns `True` if the table exists in the `stdout`, and `False` otherwise. This should fix the bug and make the function return the expected values for the failing test cases provided.