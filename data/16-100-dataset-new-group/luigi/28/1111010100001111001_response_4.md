The bug in the `table_exists` function is caused by the incorrect construction of the `stdout` variable. In the first case, the function is checking if the table name is in the output of a hive command. However, in the second case, when a partition is specified, the function is checking for the presence of any output only.

To fix this bug, we need to construct the `stdout` variable differently based on whether a partition is specified or not. If a partition is specified, we need to check if the specific partition exists in the output, rather than just checking if there is any output.

Here's the corrected version of the function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))
        return stdout and table in stdout
    else:
        stdout = run_hive_cmd("""use {0}; show partitions {1} partition({2})""".format(database, table, self.partition_spec(partition)))
        return any(partition in line for line in stdout.split('\n'))
```