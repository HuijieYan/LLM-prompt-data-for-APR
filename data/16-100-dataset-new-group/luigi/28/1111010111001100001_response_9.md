The bug in the `table_exists` function seems to be caused by incorrect processing of the `partition` parameter when it is not None. The code incorrectly constructs the Hive command in the else block and doesn't properly check if the table exists in the specified partition.

To fix the bug, we should modify the else block to correctly construct the Hive command and check if the table exists in the specified partition.

Here's a corrected version of the `table_exists` function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))
        return stdout and table in stdout
    else:
        partition_cmd = self.partition_spec(partition)
        stdout = run_hive_cmd('use {0}; show partitions {1} PARTITION ({2});'.format(database, table, partition_cmd))
        return bool(stdout)
```

This corrected version should now correctly handle the case when a partition is specified and pass the failing test cases.