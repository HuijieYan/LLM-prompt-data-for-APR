The bug in the `table_exists` function seems to be related to the `run_hive_cmd` and `self.partition_spec` functions. The function fails to properly handle the input parameters and construct the command to check if a table exists in a Hive database.

The bug causes the function to fail when checking for the existence of a table in the database. The incorrect construction of the command and handling of output results in the function returning incorrect values.

To fix the bug, the function needs to properly handle the construction of the command to check for the table existence and handle the output from the `run_hive_cmd` function.

Here's the corrected version of the function:

```python
class HiveCommandClient(HiveClient):
    def table_exists(self, table, database='default', partition=None):
        if partition is None:
            stdout = run_hive_cmd('use {0}; show tables in {1} like "{2}";'.format(database, table, table))
            return stdout and table in stdout
        else:
            partition_string = ", ".join(["{0} = '{1}'".format(k, v) for k, v in partition.items()])
            stdout = run_hive_cmd("use {0}; show partitions {1} partition ({2})".format(database, table, partition_string))
            return bool(stdout)
```

In the corrected version, the function constructs the command differently based on whether a partition is specified or not. It handles the output correctly and returns the expected boolean value based on the presence of the table.