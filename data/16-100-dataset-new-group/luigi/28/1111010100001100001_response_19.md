The bug seems to be related to the comparison of the table name with the output from the `run_hive_cmd` function. In the first branch of the `if` statement, the function checks if the table name is in the `stdout` variable, which might not be reliable since the string comparison may not be accurate. The second branch then checks if `stdout` exists, but this can be a non-empty string even if the table does not exist.

To fix the bug, instead of relying on string comparison, we should parse the output of the `run_hive_cmd` function to determine if the table exists.

Here's the corrected version of the function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))
        tables = stdout.split("\n")
        return table in tables
    else:
        stdout = run_hive_cmd("""use %s; show partitions %s partition
                            (%s)""" % (database, table, self.partition_spec(partition)))
        return stdout != ""
```

In the first branch, we split the `stdout` by the newline character and then check if `table` is in the list of tables. In the second branch, we simply return whether `stdout` is non-empty. This approach is more reliable in determining whether the table exists or not.