The bug in the `table_exists` function arises from the incorrect use of the `partition_spec` function and an improperly formatted query when the `partition` parameter is not None.

The `table_exists` function checks if a table exists in a given database and optionally in a specific partition. When `partition` is None, it constructs a query using the `run_hive_cmd` function to check for the existence of the table, whereas when `partition` is not None, it uses the `run_hive_cmd` function with a formatted query that includes the result of calling `self.partition_spec(partition)`.

The bug occurs when constructing the query with the `partition` parameter. The string formatting is incorrect and results in invalid HiveQL syntax when `self.partition_spec(partition)` is replaced with the actual partition specification. Additionally, the logic for checking the output of `run_hive_cmd` is also flawed.

To fix the bug, we need to update the query formatting and the logic for checking the output of `run_hive_cmd`, as well as ensuring the proper use of the `self.partition_spec` function. 

Here's the corrected version of the `table_exists` function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))
        return stdout and table in stdout
    else:
        partition_spec_query = self.partition_spec(partition)
        stdout = run_hive_cmd("use {0}; show partitions {1} partition ({2});".format(database, table, partition_spec_query))
        return table in stdout.split()
```

In the corrected version:
1. The query construction is updated to include the proper syntax for querying partitions.
2. The result from `run_hive_cmd` is split into a list of partitions, and the function now checks if the partition specified is in the list of partitions returned by the `run_hive_cmd` function.