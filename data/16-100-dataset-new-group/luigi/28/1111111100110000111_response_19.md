The cause of the bug is that the `table_exists` function is not case-insensitive. When checking for the existence of a table, it does not consider the case of the table name, leading to test failures.

### Strategy for fixing the bug:
1. Modify the `table_exists` function to convert both the table name and the stdout to lower case before comparing.
2. Update the function to return True if the lowercased table name is in the lowercased stdout.

### Corrected version of the function:
```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))

        return stdout and table.lower() in stdout.lower()
    else:
        stdout = run_hive_cmd("""use %s; show partitions %s partition
                          (%s)""" % (database, table, self.partition_spec(partition)))

        return bool(stdout)  # This is to directly return the condition evaluation, as it's already a boolean
```