The bug in the `table_exists` function is that when a partition is provided, the `run_hive_cmd` function call is incorrectly formatted, and the `self.partition_spec` method is being used in an incorrect way. 

To fix this bug, we need to modify the formatting of the `run_hive_cmd` function call to correctly include the partition, and use the `self.partition_spec` method in the correct way. Additionally, we should update the logic to check if the table exists based on the `stdout` value.

Here's the corrected version of the function:

```python
class HiveCommandClient(HiveClient):
    # existing class code...

    def table_exists(self, table, database='default', partition=None):
        if partition is None:
            stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))
            return stdout and table in stdout
        else:
            cmd = """use {0}; show partitions {1} partition ({2})""".format(database, table, partition)
            stdout = run_hive_cmd(cmd)
            return stdout and any(partition in line for line in stdout.split('\n'))
```