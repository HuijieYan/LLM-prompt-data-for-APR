The cause of the bug in the provided function is that the `table_exists` function is not correctly parsing the output of the `run_hive_cmd` function to determine if a table exists. The function is expecting the output of `show tables` to be returned in a certain format, and when that format is not met, it fails to correctly determine if the table exists.

To fix the bug, the function should be modified to correctly parse the output of `run_hive_cmd` to determine if a table exists.

Here is the corrected version of the function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables in {1};'.format(database, table))
        return table in stdout.split()
    else:
        stdout = run_hive_cmd("""use {0}; show partitions {1} partition
                        ({2})""".format(database, table, self.partition_spec(partition)))

        return bool(stdout)  # An empty string will return False, otherwise True
```

This corrected version should pass the failing test cases.