The bug in the `table_exists` function occurs because the `run_hive_cmd` function is not properly handling the query input. When the database, table, and partition are provided, the query is not constructed correctly. 

To fix the bug, we need to construct the query string properly and handle the output of the `run_hive_cmd` function based on the type of query.

Here's the corrected version of the function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table)).strip()

        if stdout == 'OK':
            return True
        else:
            return False
    else:
        stdout = run_hive_cmd('use {0}; show partitions {1} partition ({2});'.format(database, table, self.partition_spec(partition))).strip()

        if stdout == 'OK\n{0}'.format(partition):
            return True
        else:
            return False
```

In this corrected version:
- We properly construct the query strings for both cases by using formatted strings.
- We use the `strip` method to remove any leading/trailing whitespace in the output.
- We check the output of `run_hive_cmd` to see if it matches the expected format and return `True` or `False` accordingly.