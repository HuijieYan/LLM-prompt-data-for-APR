The bug in the function is that it's not handling the case-insensitivity of the table names correctly. It is also not correctly handling the partition parameter when checking for table existence.

### Bug Explanation:
1. When checking table existence, the function should account for case-insensitivity in table names.
2. In the case where a partition is provided, the function is not properly constructing the command to check for table existence with the given partition.

### Bug Fix:
1. To fix the case-insensitivity issue, convert both the table name and the tables received from the `show tables` command to lowercase before checking.
2. For the partition specification, when building the command to check for table existence, ensure that the partition information is correctly included in the command.

### Corrected Function:
```python
class HiveCommandClient(HiveClient):
    def table_exists(self, table, database='default', partition=None):
        table = table.lower()  # Convert table name to lowercase
        if partition is None:
            stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))

            return stdout and table in stdout.lower()  # Convert output and table name to lowercase for case-insensitive comparison
        else:
            partition_string = ' AND '.join(['{}="{}"'.format(k, v) for k, v in partition.items()])
            stdout = run_hive_cmd("""use {0}; show partitions {1} partition
                                    ({2})""".format(database, table, table, partition_string))

            return bool(stdout)  # Return True if stdout is not empty
```

By making these changes, the function should now correctly handle case-insensitive comparisons and construct the partition specification for checking table existence. This should resolve the failing tests and fulfill the expected input/output values.