The bug in the code seems to be in the 'table_exists' function, where the condition checking for the presence of a table or partition is incorrect. The function returns the opposite of what is expected in both the if and else blocks, leading to incorrect outputs and failing the test cases.

The strategy for fixing the bug is to correct the condition checking for the existence of a table or partition. Additionally, return True when the condition is met and False otherwise.

Here's the corrected version of the function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))

        return table in stdout
    else:
        stdout = run_hive_cmd("""use %s; show partitions %s partition
                            (%s)""" % (database, table, self.partition_spec(partition)))

        return bool(stdout)
```

With the corrected version, the 'table_exists' function should now return the correct results and pass the failing test cases.