The bug in the `table_exists` function is due to incorrect conditional checks and the use of `self.partition_spec(partition)` which does not seem to exist in the given class.

To fix the bug, the function should correctly run the hive commands and properly check the output for the existence of the table or partition.

Here's the corrected version:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))
    
        return table in stdout.split('\n')
    else:
        stdout = run_hive_cmd('use {0}; show partitions {1} partition ({2})'.format(database, table, ' and '.join(['{0}="{1}"'.format(k, v) for k, v in partition.items()])))
        
        return bool(stdout)
```