The cause of the bug is that the function does not properly handle the case when the table exists, resulting in incorrect return values. Additionally, the function does not handle case sensitivity for table names, causing test failures for tables with different case patterns.

To fix the bug, we need to modify the function to properly check if the table exists and handle case sensitivity for table names.

Here's the corrected version of the function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables in {1}'.format(table, database))
        tables = stdout.split('\n')
        return table.lower() in [t.lower() for t in tables if t]
    else:
        stdout = run_hive_cmd("""use {0}; show partitions {1} partition ({2})""".format(database, table, self.partition_spec(partition)))
        return stdout is not None and stdout.strip() != ''
```

This corrected version addresses the issues by properly handling case sensitivity and returning the correct boolean value based on whether the table exists or not.