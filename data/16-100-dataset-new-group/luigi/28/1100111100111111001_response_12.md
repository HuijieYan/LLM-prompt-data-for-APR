The bug in the `table_exists` function is causing the failing tests, as it is not returning the expected results.

The bug is in the `else` block of the function, where the `run_hive_cmd` function is called to check for the existence of the table with a given partition. The issue seems to be with the construction of the command string.

To fix the bug, the string formatting in the `else` block of the `table_exists` function needs to be corrected. The `run_hive_cmd` command should be constructed as follows:
```python
stdout = run_hive_cmd("""use %s; show partitions %s.%s""" % (database, table, self.partition_spec(partition)))
```

Here's the corrected version of the `table_exists` function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))
        return stdout and table in stdout
    else:
        stdout = run_hive_cmd("""use %s; show partitions %s.%s""" % (database, table, self.partition_spec(partition)))
        if stdout:
            return True
        else:
            return False
```