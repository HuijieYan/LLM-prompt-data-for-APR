The issue with the `table_exists` function is that the condition checks for the string `OK` in the `stdout` variable, and if it exists, it returns `True`. This approach is causing the failure in the test cases.

Given that the test cases simulate the different return values from the `run_hive_cmd` function, there are a few issues identified:
1. The function does not handle case insensitivity for table names.
2. The function does not handle partitioning properly, it does not use the correct condition for partitioned tables.

To fix the bug, we should update the `table_exists` function to properly handle the different cases of inputs (including case insensitivity and partitioned tables), as well as the return values from `run_hive_cmd`.

Here's the corrected version of the function:

```python
def table_exists(self, table, database='default', partition=None):
    def normalize_table_name(name):
        return name.lower()
    
    normalized_table = normalize_table_name(table)
    
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables in {1};'.format(database, database))

        return any(normalize_table_name(t) == normalized_table for t in stdout.split("\n"))
    else:
        stdout = run_hive_cmd("""show partitions {0}.{1} partition
                            {2}""".format(database, table, self.partition_spec(partition)))

        return bool(stdout.strip())
```

With this corrected version, the function will now properly handle the different cases of input table names, as well as take into account the partitioned tables and the return values from the `run_hive_cmd` function.