The bug in the `table_exists` function seems to be related to the way the `run_hive_cmd` and `self.partition_spec` functions are being called. 

In the first condition of the `table_exists` function, when `partition` is None, the `stdout` variable is being checked to see if the `table` exists in it by using the expression `return stdout and table in stdout`. This seems to be correct.

However, in the second condition, when `partition` is not None, there is an issue with how the `run_hive_cmd` and `self.partition_spec` functions are being called. The string formatting and use of `%s` and `%` is causing the issue. 

To fix this bug, we should modify the line using `run_hive_cmd` as follows:
```python
stdout = run_hive_cmd(f"use {database}; show partitions {table} partition ({', '.join([f'{key}={value}' for key, value in partition.items()])})")
```

This modified line uses f-strings for string formatting and joins the partition key-value pairs using a comma and space.

Here's the corrected version of the `table_exists` function:
```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))
        return stdout and table in stdout
    else:
        stdout = run_hive_cmd(f"use {database}; show partitions {table} partition ({', '.join([f'{key}={value}' for key, value in partition.items()])})")
        return bool(stdout)
```