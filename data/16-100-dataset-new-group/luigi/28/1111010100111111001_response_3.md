The bug in the `table_exists` function occurs because the check for the table name in the `stdout` variable is not being performed correctly, causing the incorrect return values.

The bug is caused by the conditional check `return stdout and table in stdout` in the first part of the function, and the lack of table name check in the second part. The check `return stdout and table in stdout` only checks if `stdout` exists and contains the `table` string. However, in the second part of the function, the check for the table name in `stdout` is missing.

To fix the bug, we need to ensure that both parts of the function properly check for the existence of the table in the `stdout` variable.

Below is the corrected version of the function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))

        return "OK\n" in stdout.split()
    else:
        stdout = run_hive_cmd("""use %s; show partitions %s partition
                            (%s)""" % (database, table, self.partition_spec(partition)))

        return "OK\n" in stdout.split()
```

In this corrected version, we use `stdout.split()` to split the lines in the `stdout` variable and then check for the presence of the "OK" string in the resulting list. This allows us to accurately determine the existence of the table, whether in the main tables or in the partitioned tables.