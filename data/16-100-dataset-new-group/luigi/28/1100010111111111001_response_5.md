The issue here appears to be with the `table_exists` function. It seems to be returning the opposite of what is expected in both cases. In Case 1, the function is returning false when it should return true, and in Case 2, it is returning true when it should return false.

The bug is likely in the conditional statements that determine the return value based on the `stdout`. It seems that the conditions are inverted, leading to the incorrect return values.

To fix this bug, we need to adjust the conditional statements to return the correct values based on the `stdout` variable. If `stdout` is not empty, the function should return true; otherwise, it should return false.

Here is the corrected version of the `table_exists` function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))

        return bool(stdout)  # return True if stdout is not empty, else False
    else:
        stdout = run_hive_cmd("""use %s; show partitions %s partition
                        (%s)""" % (database, table, self.partition_spec(partition)))

        return bool(stdout)  # return True if stdout is not empty, else False

```

With this correction, the function should now return the expected values in the failing test cases.