The bug in the `table_exists` function is that the conditional statements are not checking the correct conditions and the return values are not being handled properly. The function is returning the opposite result of what is expected in some cases.

To fix the bug, we need to modify the conditional statements and handle the return values correctly based on the conditions.

Here's the corrected version of the function:

```python
# The relative path of the corrected file: luigi/contrib/hive.py

def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))
        return table in stdout if stdout else False
    else:
        stdout = run_hive_cmd("""use {0}; show partitions {1} partition
                        ({2})""".format(database, table, self.partition_spec(partition)))
        return bool(stdout)
```

This corrected version should fix the bug and pass the failing test cases.