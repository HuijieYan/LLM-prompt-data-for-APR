The bug in the `table_exists` function seems to be related to the way the `run_hive_cmd` and `self.partition_spec` functions are being called within the conditional statements. 

The bug appears to be in the conditional logic when checking if the table exists with a given partition. It seems that when passing a partition to the function, the `stdout` variable is not being correctly updated, leading to incorrect return values.

### Bug in the code
When passing a partition to the `table_exists` function, the `run_hive_cmd` function is not properly called, and the `stdout` variable is not being updated with the correct output. This causes the function to incorrectly return `True` even if the table does not exist for the specified partition.

### Strategy for fixing the bug
To fix the bug, we need to ensure that the `run_hive_cmd` function is being called correctly when a partition is specified. Additionally, we need to verify that the `stdout` variable is updated with the correct output in both conditional branches.

### Corrected version of the function
```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))

        return stdout and table in stdout
    else:
        partition_query = self.partition_spec(partition)
        stdout = run_hive_cmd('use {0}; show partitions {1} partition ({2});'.format(database, table, partition_query))

        return table in stdout
```

In the corrected version of the function, we ensure that the `run_hive_cmd` function is called with the correct query for both cases. Additionally, we update the `stdout` variable with the output from the `run_hive_cmd` function in each conditional branch. This should address the bug and ensure that the function returns the correct values.