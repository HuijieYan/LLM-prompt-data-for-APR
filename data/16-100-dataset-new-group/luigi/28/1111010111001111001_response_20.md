The buggy function has several issues: 
1. The condition to check if the table exists is incorrect, leading to incorrect returns in some cases.
2. The partition functionality is not implemented correctly and results in incorrect outputs.

To fix the bug, the condition to check if the table exists needs to be modified to properly handle the `stdout` value. Additionally, the partition functionality needs to be fixed to return the correct result.

Here's the corrected version of the function:

```python
def table_exists(self, table, database='default', partition=None):
    if not partition:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))

        return 'OK' in stdout.splitlines()
    else:
        stdout = run_hive_cmd("""use {0}; show partitions {1} partition
                            ({2})""".format(database, table, self.partition_spec(partition)))

        return 'OK' in stdout.splitlines()
```

With this correction, the function should now correctly determine whether a table exists and handle partitions as expected, passing all the failing tests.