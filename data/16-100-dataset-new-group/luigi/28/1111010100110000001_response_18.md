The bug is in the `table_exists` function of the `HiveCommandClient` class inside the `luigi/contrib/hive.py` file. The issue is caused by the condition check in the `table_exists` function, which is not properly handling the response from the `run_hive_cmd` function.

The `run_hive_cmd` function is supposed to return the table name or `None` when using a single command, but it's returning "OK" instead. This causes the code to behave unexpectedly as it relies on the output of `run_hive_cmd` to determine whether the table exists.

To fix this bug, we need to modify the way the `run_hive_cmd` output is handled in the `table_exists` function. We should also revise the logic to handle the different possible responses from `run_hive_cmd`.

Here's the corrected version of the `table_exists` function:

```python
class HiveCommandClient(HiveClient):
    def table_exists(self, table, database='default', partition=None):
        if partition is None:
            stdout = run_hive_cmd('use {0}; show tables in {1};'.format(database, table))
            return stdout and table in stdout.split("\n")[1:]  # remove the header and check for the table

        else:
            stdout = run_hive_cmd(f"use {database}; show partitions {table}{self.partition_spec(partition)};")  # use f-strings for better readability
            return bool(stdout)  # The 'if' condition check is simplified, as stdout is already a truthy value

```

The key changes made are:
1. For the `table_exists` function, we're modifying the way the output of `run_hive_cmd` is handled. We explicitly split the output by newline and check for the presence of the table.
2. For the case where a partition is specified, the last if-else block is simplified using `bool(stdout)` instead of the original condition.

These changes should resolve the issue and ensure that the `table_exists` function behaves as expected. After making the changes, the failing test cases provided should pass successfully.