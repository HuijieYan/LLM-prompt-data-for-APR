The bug in the `table_exists` function is that in the case where a partition is not None, the `run_hive_cmd` function is called incorrectly. The string formatting for the command is incorrect and does not include the partition information. This leads to the function not working as intended.

To fix this bug, we need to modify the string formatting for the command when a partition is provided, so that it includes the partition information.

Here's the corrected version of the `table_exists` function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))

        return stdout and table in stdout
    else:
        partition_str = ', '.join(['{}={}'.format(key, value) for key, value in partition.items()])
        stdout = run_hive_cmd("""use {0}; show partitions {1} partition ({2})""".format(database, table, partition_str))

        return bool(stdout)
```

In the corrected version, we include the partition information in the command when a partition is provided, and we use `bool(stdout)` directly to check if `stdout` has a value. This should fix the bug and make the function pass the failing test.