The bug in the `table_exists` function is that it incorrectly returns True when it should be False and vice versa when checking if a table exists.

In the first case, when the table exists, the function should return True, but it returns False, causing the assertion error. Similarly, for the case when the table does not exist, the function should return False, but it returns True, which also needs to be corrected.

Here's the corrected version of the `table_exists` function:

```python
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))
        return table in stdout
    else:
        stdout = run_hive_cmd("""use %s; show partitions %s partition
                        (%s)""" % (database, table, self.partition_spec(partition)))
        return bool(stdout)
```

In the corrected function, when checking for table existence without a partition, it will return True if the table is in the stdout, and False if it's not. Similarly, when checking for table existence with a partition, it will return True if stdout is not empty, indicating the existence of the table, and False if it's empty.