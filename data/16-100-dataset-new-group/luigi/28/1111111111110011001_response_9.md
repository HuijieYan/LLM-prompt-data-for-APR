```python
# The corrected version of the buggy function
def table_exists(self, table, database='default', partition=None):
    if partition is None:
        stdout = run_hive_cmd('use {0}; show tables like "{1}";'.format(database, table))

        return stdout.strip() == 'OK'
    else:
        partition_clause = ', '.join(["{}='{}'".format(k, v) for k, v in partition.items()])
        stdout = run_hive_cmd("use {db}; show partitions {tbl} partition ({part})".format(
            db=database, tbl=table, part=partition_clause
        ))

        return bool(stdout.strip())
```