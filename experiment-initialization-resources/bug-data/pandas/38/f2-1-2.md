# Error stack trace

```json
[
    [
        "self = MultiIndex([(0, 0)],\n           names=['i1', 'i6']), level = 2\n\n    def _get_level_number(self, level) -> int:\n        count = self.names.count(level)\n        if (count > 1) and not is_integer(level):\n            raise ValueError(\n                f\"The name {level} occurs multiple times, use a level number\"\n            )\n        try:\n>           level = self.names.index(level)",
        "\npandas/core/indexes/multi.py:1402: ValueError\n\nThe above exception was the direct cause of the following exception:\n\nself = <pandas.tests.frame.test_reshape.TestDataFrameReshape object at 0x7f7f673ed1c0>\n\n    def test_unstack_long_index(self):\n        # PH 32624: Error when using a lot of indices to unstack.\n        # The error occurred only, if a lot of indices are used.\n        df = pd.DataFrame(\n            [[1]],\n            columns=pd.MultiIndex.from_tuples([[0]], names=[\"c1\"]),\n            index=pd.MultiIndex.from_tuples(\n                [[0, 0, 1, 0, 0, 0, 1]],\n                names=[\"i1\", \"i2\", \"i3\", \"i4\", \"i5\", \"i6\", \"i7\"],\n            ),\n        )\n>       result = df.unstack([\"i2\", \"i3\", \"i4\", \"i5\", \"i6\", \"i7\"])\n\npandas/tests/frame/test_reshape.py:779: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \npandas/core/frame.py:6452: in unstack\n    return unstack(self, level, fill_value)\npandas/core/reshape/reshape.py:403: in unstack\n    return _unstack_multiple(obj, level, fill_value=fill_value)\npandas/core/reshape/reshape.py:365: in _unstack_multiple\n    result = result.unstack(val, fill_value=fill_value)\npandas/core/frame.py:6452: in unstack\n    return unstack(self, level, fill_value)\npandas/core/reshape/reshape.py:413: in unstack\n    return _unstack_frame(obj, level, fill_value=fill_value)\npandas/core/reshape/reshape.py:437: in _unstack_frame\n    return _Unstacker(\npandas/core/reshape/reshape.py:115: in __init__\n    self.level = self.index._get_level_number(level)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MultiIndex([(0, 0)],\n           names=['i1', 'i6']), level = 2\n\n    def _get_level_number(self, level) -> int:\n        count = self.names.count(level)\n        if (count > 1) and not is_integer(level):\n            raise ValueError(\n                f\"The name {level} occurs multiple times, use a level number\"\n            )\n        try:\n            level = self.names.index(level)\n        except ValueError as err:\n            if not is_integer(level):\n                raise KeyError(f\"Level {level} not found\") from err\n            elif level < 0:\n                level += self.nlevels\n                if level < 0:\n                    orig_level = level - self.nlevels\n                    raise IndexError(\n                        f\"Too many levels: Index has only {self.nlevels} levels, \"\n                        f\"{orig_level} is not a valid level number\"\n                    ) from err\n            # Note: levels are zero-based\n            elif level >= self.nlevels:\n>               raise IndexError(\n                    f\"Too many levels: Index has only {self.nlevels} levels, \"\n                    f\"not {level + 1}\"\n                ) from err",
        "\npandas/core/indexes/multi.py:1416: IndexError"
    ],
    [
        "self = <pandas.tests.frame.test_reshape.TestDataFrameReshape object at 0x7f7f67341d30>\n\n    def test_unstack_multi_level_cols(self):\n        # PH 24729: Unstack a df with multi level columns\n        df = pd.DataFrame(\n            [[0.0, 0.0], [0.0, 0.0]],\n            columns=pd.MultiIndex.from_tuples(\n                [[\"B\", \"C\"], [\"B\", \"D\"]], names=[\"c1\", \"c2\"]\n            ),\n            index=pd.MultiIndex.from_tuples(\n                [[10, 20, 30], [10, 20, 40]], names=[\"i1\", \"i2\", \"i3\"],\n            ),\n        )\n>       assert df.unstack([\"i2\", \"i1\"]).columns.names[-2:] == [\"i2\", \"i1\"]",
        "\npandas/tests/frame/test_reshape.py:801: AssertionError"
    ],
    [
        "self = <pandas.tests.frame.test_reshape.TestDataFrameReshape object at 0x7f7f62dac100>\n\n    def test_unstack_multi_level_rows_and_cols(self):\n        # PH 28306: Unstack df with multi level cols and rows\n        df = pd.DataFrame(\n            [[1, 2], [3, 4], [-1, -2], [-3, -4]],\n            columns=pd.MultiIndex.from_tuples([[\"a\", \"b\", \"c\"], [\"d\", \"e\", \"f\"]]),\n            index=pd.MultiIndex.from_tuples(\n                [\n                    [\"m1\", \"P3\", 222],\n                    [\"m1\", \"A5\", 111],\n                    [\"m2\", \"P3\", 222],\n                    [\"m2\", \"A5\", 111],\n                ],\n                names=[\"i1\", \"i2\", \"i3\"],\n            ),\n        )\n        result = df.unstack([\"i3\", \"i2\"])\n        expected = df.unstack([\"i3\"]).unstack([\"i2\"])\n>       tm.assert_frame_equal(result, expected)\n\npandas/tests/frame/test_reshape.py:820: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \npandas/_libs/testing.pyx:65: in pandas._libs.testing.assert_almost_equal\n    cpdef assert_almost_equal(a, b,\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n>   raise_assert_detail(obj, msg, lobj, robj, index_values=index_values)",
        "\npandas/_libs/testing.pyx:180: AssertionError"
    ]
]
```
