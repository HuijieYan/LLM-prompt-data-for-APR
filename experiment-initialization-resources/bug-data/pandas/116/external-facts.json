{
    "pandas:116": {
        "github_issue_title": [
            "pd.merge_asof not working when merging TZ-aware index+series\n"
        ],
        "github_issue_description": [
            "Hi!\n\nI don't know how to solve following issue, can you please take a look? What am I doing wrong?\n\nProblem description\nimport io\nimport pandas as pd\n\n\ndata_1 = io.StringIO(\"\"\"\n                           xyz  \nfrom_date                                                       \n2019-10-01 00:30:00+00:00  0.9\n2019-10-01 01:00:00+00:00  0.8\n2019-10-01 01:30:00+00:00  0.7\n2019-10-01 02:00:00+00:00  0.6\"\"\")\ndf = pd.read_csv(data_1, sep='\\s{2,}', engine='python')\ndf.index = pd.to_datetime(df.index, utc=True)\n\n\ndata_2 = io.StringIO(\"\"\"\n                from_date         abc\n2019-10-01 00:00:00+00:00        2.46\n2019-10-01 00:30:00+00:00        2.46\n2019-10-01 01:00:00+00:00        2.46\n2019-10-01 01:30:00+00:00        2.46\n2019-10-01 02:00:00+00:00        2.19\n\"\"\")\ndf2 = pd.read_csv(data_2, sep='\\s{2,}', engine='python')\ndf2['from_date'] = pd.to_datetime(df2['from_date'], utc=True)\n\n\nprint(f\"pandas version: {pd.__version__}\")\nprint(f\"df index dtype: {df.index.dtype}\")\nprint(f\"df2 dt column dtype: {df2['from_date'].dtype}\")\nprint(\"check\", df.index.dtype == df2.from_date.dtype )\npd.merge_asof(left=df, right=df2, left_index=True, right_on=['from_date'])\nOutput\npandas version: 0.25.3\ndf index dtype: datetime64[ns, UTC]\ndf2 dt column dtype: datetime64[ns, UTC]\ncheck True\n---------------------------------------------------------------------------\nMergeError                                Traceback (most recent call last)\n<ipython-input-82-bdb9feab8f76> in <module>\n     28 print(f\"df2 dt column dtype: {df2['from_date'].dtype}\")\n     29 print(\"check\", df.index.dtype == df2.from_date.dtype )\n---> 30 pd.merge_asof(left=df, right=df2, left_index=True, right_on=['from_date'], direction='nearest')\n\nc:\\users\\asd\\lib\\site-packages\\pandas\\core\\reshape\\merge.py in merge_asof(left, right, on, left_on, right_on, left_index, right_index, by, left_by, right_by, suffixes, tolerance, allow_exact_matches, direction)\n    537         tolerance=tolerance,\n    538         allow_exact_matches=allow_exact_matches,\n--> 539         direction=direction,\n    540     )\n    541     return op.get_result()\n\nc:\\users\\asd\\lib\\site-packages\\pandas\\core\\reshape\\merge.py in __init__(self, left, right, on, left_on, right_on, left_index, right_index, by, left_by, right_by, axis, suffixes, copy, fill_method, how, tolerance, allow_exact_matches, direction)\n   1552             how=how,\n   1553             suffixes=suffixes,\n-> 1554             fill_method=fill_method,\n   1555         )\n   1556 \n\nc:\\users\\asd\\lib\\site-packages\\pandas\\core\\reshape\\merge.py in __init__(self, left, right, on, left_on, right_on, left_index, right_index, axis, suffixes, copy, fill_method, how)\n   1442             how=how,\n   1443             suffixes=suffixes,\n-> 1444             sort=True,  # factorize sorts\n   1445         )\n   1446 \n\nc:\\users\\asd\\lib\\site-packages\\pandas\\core\\reshape\\merge.py in __init__(self, left, right, how, on, left_on, right_on, axis, left_index, right_index, sort, suffixes, copy, indicator, validate)\n    624             self.right_join_keys,\n    625             self.join_names,\n--> 626         ) = self._get_merge_keys()\n    627 \n    628         # validate the merge keys dtypes. We may need to coerce\n\nc:\\users\\asd\\lib\\site-packages\\pandas\\core\\reshape\\merge.py in _get_merge_keys(self)\n   1636                         )\n   1637                     )\n-> 1638                 raise MergeError(msg)\n   1639 \n   1640         # validate tolerance; must be a Timedelta if we have a DTI\n\nMergeError: incompatible merge keys [0] dtype('<M8[ns]') and datetime64[ns, UTC], must be the same type\nExpected Output\nmerged dataframes\n"
        ]
    }
}