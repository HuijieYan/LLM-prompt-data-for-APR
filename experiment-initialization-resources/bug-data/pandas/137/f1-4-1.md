# Test code

```json
[
    "    @pytest.mark.parametrize(\n        \"expected\",\n        [\n            pd.Series([\"2019\", \"2020\"], dtype=\"datetime64[ns, UTC]\"),\n            pd.Series([0, 0], dtype=\"timedelta64[ns]\"),\n            pd.Series([pd.Period(\"2019\"), pd.Period(\"2020\")], dtype=\"period[A-DEC]\"),\n            pd.Series([pd.Interval(0, 1), pd.Interval(1, 2)], dtype=\"interval\"),\n            pd.Series([1, np.nan], dtype=\"Int64\"),\n        ],\n    )\n    def test_cast_category_to_extension_dtype(self, expected):\n        # GH 28668\n        result = expected.astype(\"category\").astype(expected.dtype)\n\n        tm.assert_series_equal(result, expected)",
    "    @pytest.mark.parametrize(\n        \"expected\",\n        [\n            pd.Series([\"2019\", \"2020\"], dtype=\"datetime64[ns, UTC]\"),\n            pd.Series([0, 0], dtype=\"timedelta64[ns]\"),\n            pd.Series([pd.Period(\"2019\"), pd.Period(\"2020\")], dtype=\"period[A-DEC]\"),\n            pd.Series([pd.Interval(0, 1), pd.Interval(1, 2)], dtype=\"interval\"),\n            pd.Series([1, np.nan], dtype=\"Int64\"),\n        ],\n    )\n    def test_cast_category_to_extension_dtype(self, expected):\n        # GH 28668\n        result = expected.astype(\"category\").astype(expected.dtype)\n\n        tm.assert_series_equal(result, expected)",
    "    @pytest.mark.parametrize(\n        \"expected\",\n        [\n            pd.Series([\"2019\", \"2020\"], dtype=\"datetime64[ns, UTC]\"),\n            pd.Series([0, 0], dtype=\"timedelta64[ns]\"),\n            pd.Series([pd.Period(\"2019\"), pd.Period(\"2020\")], dtype=\"period[A-DEC]\"),\n            pd.Series([pd.Interval(0, 1), pd.Interval(1, 2)], dtype=\"interval\"),\n            pd.Series([1, np.nan], dtype=\"Int64\"),\n        ],\n    )\n    def test_cast_category_to_extension_dtype(self, expected):\n        # GH 28668\n        result = expected.astype(\"category\").astype(expected.dtype)\n\n        tm.assert_series_equal(result, expected)",
    "    @pytest.mark.parametrize(\n        \"expected\",\n        [\n            pd.Series([\"2019\", \"2020\"], dtype=\"datetime64[ns, UTC]\"),\n            pd.Series([0, 0], dtype=\"timedelta64[ns]\"),\n            pd.Series([pd.Period(\"2019\"), pd.Period(\"2020\")], dtype=\"period[A-DEC]\"),\n            pd.Series([pd.Interval(0, 1), pd.Interval(1, 2)], dtype=\"interval\"),\n            pd.Series([1, np.nan], dtype=\"Int64\"),\n        ],\n    )\n    def test_cast_category_to_extension_dtype(self, expected):\n        # GH 28668\n        result = expected.astype(\"category\").astype(expected.dtype)\n\n        tm.assert_series_equal(result, expected)",
    "def test_merge_on_cat_and_ext_array():\n    # GH 28668\n    right = DataFrame(\n        {\"a\": Series([pd.Interval(0, 1), pd.Interval(1, 2)], dtype=\"interval\")}\n    )\n    left = right.copy()\n    left[\"a\"] = left[\"a\"].astype(\"category\")\n\n    result = pd.merge(left, right, how=\"inner\", on=\"a\")\n    expected = right.copy()\n\n    assert_frame_equal(result, expected)"
]
```
